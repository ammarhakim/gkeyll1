\documentclass[11pt, reqno]{amsart}
%% AMS packages and font files
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amsthm}
\usepackage{setspace}
\usepackage{fancyhdr}
%\pagestyle{fancyplain}
\usepackage{hyperref}
\usepackage{graphicx}
\usepackage{color}

\DeclareMathAlphabet{\mathpzc}{OT1}{pzc}{m}{it}

%% Set page size properly
%\oddsidemargin  0.0in
%\evensidemargin 0.0in
%\textwidth      6.5in
%\textheight     9.0in
%\leftmargin     1.0in
%\rightmargin    1.0in

%% Autoscaled figures
\newcommand{\incfig}{\centering\includegraphics}
\setkeys{Gin}{width=0.9\linewidth,keepaspectratio}

%% Commonly used macros
\newcommand{\eqr}[1]{Eq.\thinspace(#1)}
\newcommand{\pfrac}[2]{\frac{\partial #1}{\partial #2}}
\newcommand{\pfracc}[2]{\frac{\partial^2 #1}{\partial #2^2}}
\newcommand{\pfraca}[1]{\frac{\partial}{\partial #1}}
\newcommand{\pfracb}[2]{\partial #1/\partial #2}
\newcommand{\pfracbb}[2]{\partial^2 #1/\partial #2^2}
\newcommand{\spfrac}[2]{{\partial_{#1}} {#2}}
\newcommand{\mvec}[1]{\mathbf{#1}}
\newcommand{\gvec}[1]{\boldsymbol{#1}}
\newcommand{\script}[1]{\mathpzc{#1}}

\newtheorem{thm}{Theorem}
\newtheorem{lem}{Lemma}

\theoremstyle{definition}
\newtheorem{dfn}{Definition}

\title[Hyperbolic balance laws]{An overview of hyperbolic balance laws
  and numerical schemes with application to plasma fluid equations}%
\author{Ammar H. Hakim}%
\date{}

\begin{document}
% header text
\lhead{Tech-Note 1005}
\maketitle

Hyperbolic balance laws are a broad class of equations that describe
phenomena propagating with finite wave speeds. Coupled with source
terms they can model a diverse set of physical systems in continuum
mechanics including neutral (relativistic and non-relativistic) fluids,
electromagnetism, a variety of magnetohydrodynamics (MHD) equations,
linear and nonlinear elasticity and even equations of general
relativity. This note is an overview of hyperbolic balance laws and
numerical schemes to solve them. The intended applications are to
plasma fluid equations. Plasmas introduce unique challenges from their
inherently multiphysics nature and from the disparate time/space
scales involved. No claim to originality of the material is made, but
useful results are collected in one place for use of students and
researchers not familiar with this important class of equations.

The rest of this note is organized as follows. First, the basic
properties of hyperbolic balance laws are given, specially those
important to designing robust numerical schemes. Then, a set of
example equations are given, drawn from fluid mechanics,
electromagnetic and plasma physics. Next, the concepts of Riemann
problems and relaxation systems are introduced. These are essential to
the construction of numerical schemes. Three broad families of
numerical schemes are described. The first one is based on expansion
of the solution using Taylor series. This family is not dealt with in
detail as the schemes do not preserve, in general, important
properties of the continuous balance laws. The second family of
numerical scheme are based on reconstruction in each cell, from
averages, a high-order polynomial representation of the solution. The
third family of schemes are based on representing the solution in each
cell using a set of basis functions. Example applications of these
each of these schemes are then given.

\section{Basic properties of hyperbolic balance laws}

\subsection{Definition of hyperbolic balance laws}

Consider the $N$ dimensional system of $m$ balance laws
\begin{align}
  \spfrac{t}{U} + \sum_{i=1}^N \spfrac{i}{F_i(U)} = S(U,x,t) 
  \label{eq:hypbalance}
\end{align}
where $x = [x_1,\ldots,x_N] \in \mathbb{R}^N$, $U(x,t) \in
\mathbb{R}^m$, the smooth function $F_i(U)$ is the flux in the $i$-th
direction and $S(U,x,t) \in \mathbb{R}^m$ are source terms. In this
and the following we denote $\partial_i \equiv \partial/\partial x_i$
and $D \equiv \partial/\partial U$.

\begin{dfn}[Hyperbolic Equations]
  The system of balance laws \eqr{\ref{eq:hypbalance}} are said to be
  \emph{hyperbolic} if for any admissible $U$ the flux Jacobian
  \begin{align}
    A(U,n) \equiv \sum_{i=0}^N n_i DF_i(U)
  \end{align}
  where $n\equiv [n_1,\ldots,n_N]$ are components of a unit vector,
  has real eigenvalues and a complete set of right eigenvectors. The
  eigenvalues $\lambda_1(U,n) \le \ldots \le \lambda_m(U,n)$ are
  called the \emph{characteristic speeds} of the system. We will
  denote $r_p(U,n)$ (column vector) and $l_p(U,n)$ (row vector),
  $p=1,\ldots,m$, as the right and left eigenvectors and assume the
  normalization $l_p r_q = \delta_{pg}$.  The system is said to be
  \emph{strictly hyperbolic} if all characteristic speeds are distinct
  and \emph{isotropic} if the eigenvalues and eigenvectors do not
  depend on the unit vector $n$.
\end{dfn}

Intuitively, hyperbolic equations describe the propagation of waves,
the wave speeds given by the characteristic speeds and the local
propagation direction by the right eigenvectors. The curves traced out
by the waves are called the \emph{characteristics}. If the system is
nonlinear the wave speeds will vary and complex phenomena can
result. This is specially true in presence of sources, in which case
the waves can undergo dispersion and diffusion.

Consider a change of variables defined by $U=\varphi(V)$, where
$V(x,t) \in \mathbb{R}^m$. Such a change of variables occurs
frequently in applications, for example, going between the
non-conservative and conservative form of fluid equations. With this
change of variables \eqr{\ref{eq:hypbalance}} become
\begin{align}
  \spfrac{t}{V} + \sum_{i=1}^N 
  \varphi'(V)^{-1}
  DF_i(U)
  \varphi'(V)
  \spfrac{i}{V}
  = 
  \varphi'(V)^{-1}S(U,x,t)
  \label{eq:hypbalance_V}
\end{align}
Here primes denote differentiation with $V$. The flux Jacobian for
this system is
\begin{align}
  \tilde{A}(V,n) 
  &=
  \varphi'(V)^{-1} A(\varphi(V),n) \varphi'(V) \notag \\
  &=
  \varphi'(V)^{-1} R(\varphi(V),n) \Lambda(\varphi(V),n) L(\varphi(V),n) \varphi'(V)
\end{align}
where $L$ and $R$ are matrices of the left (arranged as rows) and
right (arranged as columns) eigenvectors and $\Lambda$ is a diagonal
matrix of the eigenvalues of $A$. From the form of this equation it is
clear that the eigenvalues of the flux Jacobian of
\eqr{\ref{eq:hypbalance_V}} are identical to the original system,
i.e. $\lambda_p(\varphi(V), n)$ while the right and left eigenvectors
are given by $\varphi'(V)^{-1} r_p(\varphi(V),n)$ and
$l_p(\varphi(V),n) \varphi'(V)$. Hence, hyperbolicity is invariant
under a invertible non-linear transform.

\subsection{Weak solutions and Rankine-Hugoniot conditions}

It is well known that the solution to \eqr{\ref{eq:hypbalance}} can
develop discontinuities in finite amount of time even if the initial
data $U(x,0)$ is smooth. In this case we must deal with \emph{weak
  solutions}, i.e. in the sense of distributions. For every smooth
test function $\phi(x,t)$ with compact support in
$\mathbb{R}^N\times[0,T)$ the weak solution satisfies
\begin{align}
  \int_0^T\int_{\mathbb{R}^N}
  \left[
    U\spfrac{t}{\phi}
    +
    \sum_{i=1}^N F_i(U)\spfrac{i}{\phi}
  \right]
  dx dt
  &+
  \int_{\mathbb{R}^N}
  \phi(x,0)U(x,0) dx
  = \notag \\
  &-
  \int_0^T\int_{\mathbb{R}^N}
  S(U,x,t)\phi(x,t)
  dx dt  
\end{align}

Discontinuous weak solutions to \eqr{\ref{eq:hypbalance}} are
characterized by the so called \emph{Rankine-Hugoniot} jump
conditions. For simplicity consider a one-dimensional system of
homogeneous equations
\begin{align}
  \spfrac{t}{U} + \spfrac{x}{F(U)} = 0
  \label{eq:hypbalance-1d}
\end{align}
Then the following Lemma holds.
\begin{lem}
  Let $\script{C}$ be a smooth curve defined by $x=\xi(t)$. Then
  $U(x,t)$ is a \emph{weak} solution to \eqr{\ref{eq:hypbalance-1d}}
  if it a smooth solution in $x<\xi(t)$ and $x>\xi(t)$ and satisfies
  the jump condition
  \begin{align}
    F(U_+) - F(U_-) = \dot{\xi}(U_+ - U_-)
  \end{align}
  where $U_\pm \equiv \lim_{x\rightarrow \xi(t)^\pm}U(x,t)$ .
\end{lem}

In the $N$-dimensional case we can generalize the Lemma as
follows. Let $\script{S}$ be a $N-1$ dimensional surface embedded in
$\mathbb{R}^N$ with local surface normal $n(\xi,t)$, where $\xi$ is a
point on $\script{S}$. Let the normal velocity of the surface be
$s$. Then the \emph{Rankine-Hugoniot} condition reads
\begin{align}
  \sum_{i=1}^N 
  n_i[F_i(U_+) - F_i(U_-)] = s(U_+ - U_-)
\end{align}

\subsection{Invariant domains}

The solution vector $U(x,t)$, in general, can take values only in a
open subset of $\mathbb{R}^m$. For example, for fluid equations the
density and pressure must remain non-negative. This leads to the
concept of \emph{invariant domains}, defined below
\begin{dfn}[Invariant Domains]
  The convex set $\script{U} \subset \mathbb{R}^m$ is said to be an
  invariant domain of \eqr{\ref{eq:hypbalance}} if it has the property
  that if $U(x,0) \in \script{U}$ then $U(x,t) \in \script{U}$ for all
  $x,t$.
\end{dfn}

Essentially, an invariant domain is the set in solution space that is
preserved on evolution by the balance law. When constructing numerical
schemes it is important to use a scheme that provably preserves
invariant domains. This is specially true if the expected solutions
are know to lie close to invariant domains boundaries, for example, in
fluid flow with vacuum regions.

\subsection{Non-uniqueness of weak solutions and entropy/entropy-flux pairs}

Uniqueness of weak solutions of hyperbolic balance laws breaks down in
many situation. Intuitively, one can imagine this happens when
characteristics of a nonlinear equation (which carry constant states
with them) intersect: which state is the solution at the intersection
point?  To restore uniqueness we need to impose an admissibility
criteria to select a class of weak solutions.

One way to do this is to introduce the concept of entropy/entropy-flux
pairs. A scalar function $\eta(U)$ is a \emph{entropy} if with it
there are associated scalar functions $\left(q_1(U), \ldots,
  q_N(U)\right)$, called the \emph{entropy fluxes}, such that for any
$U$ we have
\begin{align}
  Dq_i(U) = D\eta(U) DF_i(U) \label{eq:entropy}
\end{align}
for $i=1,\ldots,N$. Multiplying the balance law
\eqr{\ref{eq:hypbalance}} by $D\eta(U)$ and using
\eqr{\ref{eq:entropy}} we see that for smooth solutions the entropy
satisfies the companion balance law
\begin{align}
  \spfrac{t}{\eta(U)} 
  +
  \sum_{i=1}^N \spfrac{i}{g_i(U)} 
  =
  D\eta(U) S(U,x,t) 
  \label{eq:entropy-balance}
\end{align}
However, for weak solution we must impose instead
\begin{align}
  \spfrac{t}{\eta(U)} 
  +
  \sum_{i=1}^N \spfrac{i}{g_i(U)} 
  \le
  D\eta(U) S(U,x,t)   
  \label{eq:entropy-balance-weak}
\end{align}
in the sense of distributions, i.e. for every test smooth function
$\psi(x,t)$ with compact support in $\mathbb{R}^N\times[0,T)$ we have
\begin{align}
  \int_0^T\int_{\mathbb{R}^N}
  \left[
    \eta(U)\spfrac{t}{\psi}
    +
    \sum_{i=1}^N g_i(U)\spfrac{i}{\psi}
  \right]
  dx dt
  &+
  \int_{\mathbb{R}^N}
  \psi(x,0)\eta(U(x,0)) dx
  \ge \notag \\
  &-
  \int_0^T\int_{\mathbb{R}^N}
  S(U,x,t)\psi(x,t)
  dx dt  
\end{align}

A weak-solution of \eqr{\ref{eq:hypbalance}} is said to be
\emph{entropy satisfying} if \eqr{\ref{eq:entropy-balance-weak}}
holds.

\end{document}

