\documentclass[11pt, reqno]{amsart}
%% AMS packages and font files
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amsthm}
\usepackage[dvips]{graphicx}
\usepackage[usenames,dvipsnames]{color}
\usepackage{setspace}
\usepackage{fancyhdr}
%\pagestyle{fancyplain}

\DeclareMathAlphabet{\mathpzc}{OT1}{pzc}{m}{it}

%% Set page size properly
\oddsidemargin  0.0in
\evensidemargin 0.0in
\textwidth      6.5in
\textheight     9.0in
\leftmargin     1.0in
\rightmargin    1.0in

%% Autoscaled figures
\newcommand{\incfig}{\centering\includegraphics}
\setkeys{Gin}{width=0.9\linewidth,keepaspectratio}

%% Commonly used macros
\newcommand{\eqr}[1]{Eq.\thinspace(#1)}
\newcommand{\pfrac}[2]{\frac{\partial #1}{\partial #2}}
\newcommand{\pfracc}[2]{\frac{\partial^2 #1}{\partial #2^2}}
\newcommand{\pfraca}[1]{\frac{\partial}{\partial #1}}
\newcommand{\pfracb}[2]{\partial #1/\partial #2}
\newcommand{\pfracbb}[2]{\partial^2 #1/\partial #2^2}
\newcommand{\mvec}[1]{\mathbf{#1}}
\newcommand{\gvec}[1]{\boldsymbol{#1}}
\newcommand{\script}[1]{\mathpzc{#1}}

\title{An analysis of High-Resolution Wave Propagation scheme for 2D
  TM mode Maxwell equations}%
\author{Ammar H. Hakim}%
\date{}

\begin{document}
% header text
\lhead{Tech-Note 1004}
\maketitle

\section{Wave Propagation Scheme for Maxwell Equations}

In two-dimensions Maxwell equations can be written as a set of two
uncoupled systems of equations. The first system, the \emph{transverse
  magnetic} (TM), involves $[B^x, B^y, E^z]$ and the second system,
the \emph{transverse electric} (TE), $[E^x, E^y, B^z]$. In this note
we will focus on descretization of the TM system. The aim will be
write out an explicit update formula for wave propagation
scheme\footnote{See Tech-Note 1005 for overview of the wave
  propagation scheme} and determine if it can be modified to preserve
the constraint $\nabla \cdot \mvec{B} = 0$. The system of equations
is written as
\begin{align}
  \pfrac{B^x}{t} + \pfrac{E^z}{y} &= 0 \\
  \pfrac{B^y}{t} - \pfrac{E^z}{x} &= 0 \\
  \frac{1}{c^2}\pfrac{E^z}{t} - \pfrac{B^y}{x} + \pfrac{B^x}{y} &= \mu_0 J^z
\end{align}
In addition, the magnetic field must satisfy the divergence constraint
\begin{align}
  \pfrac{B^x}{x} + \pfrac{B^y}{y} &= 0
\end{align}
For linear systems it is possible to write out the explicit form of
the resulting finite-difference equations. Ignoring the currents for
now, these are, without limiters and transverse terms,
\begin{align}
  \Delta B^x_{i,j} = -\frac{\Delta t}{2\Delta y}
  \left(
    E^z_{i,j+1} - E^z_{i,j-1}
  \right)
  + \frac{c^2 \Delta t^2}{2\Delta y^2}
  \left(
    B^x_{i,j+1} - 2B^x_{i,j} + B^x_{i,j-1}
  \right)
\end{align}
\begin{align}
  \Delta B^y_{i,j} = \frac{\Delta t}{2\Delta x}
  \left(
    E^z_{i+1,j} - E^z_{i-1,j}
  \right)
  + \frac{c^2 \Delta t^2}{2\Delta x^2}
  \left(
    B^y_{i+1,j} - 2B^y_{i,j} + B^y_{i-1,j}
  \right)
\end{align}
and
\begin{align}
  \Delta E^z_{i,j} &= \frac{c^2 \Delta t}{2\Delta x}
  \left(
    B^y_{i+1,j} - B^y_{i-1,j}
  \right)
  -\frac{c^2 \Delta t}{2\Delta y}
  \left(
    B^x_{i,j+1} - B^x_{i,j-1}
  \right) \notag \\
  &+ \frac{c^2 \Delta t^2}{2\Delta x^2}
  \left(
    E^z_{i+1,j} - 2E^z_{i,j} + E^z_{i-1,j}
  \right)
  + \frac{c^2 \Delta t^2}{2\Delta y^2}
  \left(
    E^z_{i,j+1} - 2E^z_{i,j} + E^z_{i,j-1}
  \right)
\end{align}
Here we have defined, for any quantity $Q$, $\Delta Q \equiv
Q(t+\Delta t)-Q(t)$. The form of the equations indicates that the wave
propagation scheme has approximated the spatial derivatives by central
differences and added an additional diffusive term that appears, for
example, in the $\Delta B^x$ equation, as a central difference
approximation for $c^2\Delta t/\Delta y \pfracbb{B^x}{y}$. This
additional term makes the wave propagation scheme second order both in
space and time, however, it can lead to divergence errors even when
$\nabla \cdot \mvec{B} = 0$ at $t=0$. In fact, we can easily show that
the scheme effectively\footnote{By effectively we mean that
  discretizing the effective equation using central differences for
  spatial derivative and forward differences for temporal derivatives
  is equivalent to solving the original equation using the wave
  propagation method.} evolves the divergence of the magnetic field as
\begin{align}
  \pfraca{t}
  \left(
    \pfrac{B^x}{x} + \pfrac{B^y}{y}
  \right)
  =
  \frac{c^2 \Delta t}{\Delta y}
  \frac{\partial^3B^x}{\partial x \partial y^2}
  +
  \frac{c^2 \Delta t}{\Delta x}
  \frac{\partial^3B^y}{\partial y \partial x^2}
\end{align}
Note that we can not simply leave out the upwinding term in the update
formulas for the magnetic fields. The reason is that the central
difference scheme by itself is unstable. One way around this
instability of the central difference scheme is to leap-frog the
fields, i.e. compute magnetic fields at $t+\Delta t$ using electric
fields at $t + \Delta t/2$. The disadvantage of this leap-frog scheme
is that it leads to dispersion errors when the wave length become
comparable to the grid size.

\section{Wave Propagation Scheme for Perfectly Hyperbolic Maxwell
  Equations}

To preserve divergence constraints Munz suggested the use of the
perfectly hyperbolic Maxwell equations. These are, for the TM case
\begin{align}
  \pfrac{B^x}{t} + \pfrac{E^z}{y} + \gamma\pfrac{\psi}{x} &= 0 \\
  \pfrac{B^y}{t} - \pfrac{E^z}{x} + \gamma\pfrac{\psi}{y} &= 0 \\
  \frac{1}{c^2}\pfrac{E^z}{t} - \pfrac{B^y}{x} + \pfrac{B^x}{y} &=
  \mu_0 J^z \\
  \frac{1}{\gamma c^2}\pfrac{\psi}{t} + \pfrac{B^x}{x} +
  \pfrac{B^y}{y} &= 0
\end{align}
Here $\psi$ is a correction potential and $\gamma$ is a dimensionless
number. In this system the divergence constraint is explicitly
incorporated by the introduction of the $\psi(x,y,t)$ scalar field.
This extended system of equations has eigenvalues $\pm c, \pm \gamma
c$. Discretizing this system using the wave propagation scheme gives
\begin{align}
  \Delta B^x_{i,j} = &-\frac{\Delta t}{2\Delta y}
  \left(
    E^z_{i,j+1} - E^z_{i,j-1}
  \right)
  +
  \frac{c^2 \Delta t^2}{2\Delta y^2}
  \left(
    B^x_{i,j+1} - 2B^x_{i,j} + B^x_{i,j-1}
  \right) \notag \\
  &-
  \frac{\gamma \Delta t}{2\Delta x}
  \left(
    \psi_{i+1,j}-\psi_{i-1,j}
  \right)
  +
  \frac{\gamma^2 c^2 \Delta t^2}{2\Delta x^2}
  \left(
    B^x_{i+1,j} - 2B^x_{i,j} + B^x_{i-1,j}
  \right)
\end{align}
\begin{align}
  \Delta B^y_{i,j} = 
  &\frac{\Delta t}{2\Delta x}
  \left(
    E^z_{i+1,j} - E^z_{i-1,j}
  \right)
  + \frac{c^2 \Delta t^2}{2\Delta x^2}
  \left(
    B^y_{i+1,j} - 2B^y_{i,j} + B^y_{i-1,j}
  \right) \notag \\
  &
  -
  \frac{\gamma \Delta t}{2\Delta y}
  \left(
    \psi_{i,j+1}-\psi_{i,j-1}
  \right)
  +
  \frac{\gamma^2 c^2 \Delta t^2}{2\Delta y^2}
  \left(
    B^y_{i,j+1} - 2B^y_{i,j} + B^y_{i,j-1}
  \right)  
\end{align}
\begin{align}
  \Delta E^z_{i,j} &= \frac{c^2 \Delta t}{2\Delta x}
  \left(
    B^y_{i+1,j} - B^y_{i-1,j}
  \right)
  -\frac{c^2 \Delta t}{2\Delta y}
  \left(
    B^x_{i,j+1} - B^x_{i,j-1}
  \right) \notag \\
  &+ \frac{c^2 \Delta t^2}{2\Delta x^2}
  \left(
    E^z_{i+1,j} - 2E^z_{i,j} + E^z_{i-1,j}
  \right)
  + \frac{c^2 \Delta t^2}{2\Delta y^2}
  \left(
    E^z_{i,j+1} - 2E^z_{i,j} + E^z_{i,j-1}
  \right)
\end{align}
and
\begin{align}
  \Delta \psi_{i,j} = 
  \frac{\gamma c^2 \Delta t}{2 \Delta x}
  \left(
    B^x_{i+1,j} - B^x_{i-1,j}
  \right)
  +
  \frac{\gamma^2 c^2 \Delta t^2}{2 \Delta x^2}
  \left(
    \psi_{i+1,j} - 2\psi_{i,j} + \psi_{i-1,j}
  \right) \notag \\
  +
  \frac{\gamma c^2 \Delta t}{2 \Delta y}
  \left(
    B^y_{i,j+1} - B^y_{i,j-1}
  \right)
  +
  \frac{\gamma^2 c^2 \Delta t^2}{2 \Delta y^2}
  \left(
    \psi_{i,j+1} - 2\psi_{i,j} + \psi_{i,j-1}
  \right)
\end{align}
As expected, the wave propagation scheme approximates the spatial
derivatives using central differences and adds a diffusion term to
stabilize the scheme. For the PH Maxwell case we now have
\begin{align}
  \pfraca{t}
  \left(
    \pfrac{B^x}{x} + \pfrac{B^y}{y}
  \right)
  +
  \gamma \pfracc{\psi}{x} + \gamma \pfracc{\psi}{y}
  =
  \frac{c^2 \Delta t}{\Delta y}
  \frac{\partial^3B^x}{\partial x \partial y^2}
  +
  \frac{c^2 \Delta t}{\Delta x}
  \frac{\partial^3B^y}{\partial y \partial x^2}
  +
  \frac{\gamma^2 c^2 \Delta t}{\Delta x}
  \frac{\partial^3B^x}{\partial x^3}
  +
  \frac{\gamma^2 c^2 \Delta t}{\Delta y}
  \frac{\partial^3B^y}{\partial y^3}
\end{align}

\end{document}

