\documentclass[pdf]{beamer}
\usepackage{biblatex}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{caption}
\usepackage{longtable}
\usepackage{multirow}
\usepackage{tabulary}
\usepackage{movie15}


\captionsetup{font=scriptsize,labelfont=scriptsize}
\footnotesize\small

\DeclareMathAlphabet{\mathpzc}{OT1}{pzc}{m}{it}

\newcommand{\eqr}[1]{Eq.\thinspace(#1)}
\newcommand{\pfrac}[2]{\frac{\partial #1}{\partial #2}}
\newcommand{\pfracc}[2]{\frac{\partial^2 #1}{\partial #2^2}}
\newcommand{\pfraca}[1]{\frac{\partial}{\partial #1}}
\newcommand{\pfracb}[2]{\partial #1/\partial #2}
\newcommand{\pfracbb}[2]{\partial^2 #1/\partial #2^2}
\newcommand{\spfrac}[2]{{\partial_{#1}} {#2}}
\newcommand{\mvec}[1]{\mathbf{#1}}
\newcommand{\gvec}[1]{\boldsymbol{#1}}
\newcommand{\script}[1]{\mathpzc{#1}}
\newcommand{\eep}{\mvec{e}_\phi}
\newcommand{\eer}{\mvec{e}_r}
\newcommand{\eez}{\mvec{e}_z}
\newcommand{\iprod}[2]{\langle{#1}\rangle_{#2}}
%\newcommand{\mypause}{\pause}
\newcommand{\mypause}{}

\newtheorem{thm}{Theorem}
\newtheorem{lem}{Lemma}

\theoremstyle{definition}
\newtheorem{dfn}{Definition}
%\newtheorem{thm}{Theorem}
\newtheorem{proposed}{Proposed Answer}
\DeclareMathOperator{\spn}{span}

%% autoscaled figures
\newcommand{\incfig}{\centering\includegraphics}
\setkeys{Gin}{width=0.7\linewidth,keepaspectratio}

\usepackage{beamerthemesplit}
\setbeamercovered{transparent}
\usetheme{lined}
%\usetheme{CambridgeUS}
\usecolortheme{dolphin}

\usefonttheme[onlymath]{serif}
\setbeamertemplate{navigation symbols}{}

% Setup TikZ
\usepackage{tikz}
\usetikzlibrary{arrows}
\tikzstyle{block}=[draw opacity=0.7,line width=1.4cm]

\title[Continuum Discontinuous Galerkin Algorithms]{An overview of
  discontinuous Galerkin algorithms with applications to (gyro)
  kinetic simulations of plasmas}%
\author{A. H. Hakim \and G. W. Hammett}%

\institute[http://www.ammar-hakim.org/sj] % (optional, aber oft n√∂tig)
{
  Princeton Plasma Physics Laboratory, Princeton, NJ\\
  ammar@princeton.edu\\
  \url{http://www.ammar-hakim.org/sj}
}

\date[Theory Seminar]{PPPL Theory Seminar, 13$^\mathrm{th}$~December
  2012}

\bibliography{gke}
%\footfullcite{jones00}
\begin{document}

\begin{frame}
  \titlepage
\end{frame}

%----------------------------------------------------------------
\begin{frame}{Edge region of tokamaks and stellerators is very
    important but poorly understood}

  \begin{figure}
    \setkeys{Gin}{width=0.75\linewidth,keepaspectratio}
    \incfig{edge-important.png}
  \end{figure}

  \begin{itemize}
    \small
  \item Need sufficiently high pedestal temperature for core to get to
    fusion temperatures
  \item Periodic instabilities in edge region can dump outer ~5-10\%
    of plasma onto divertor plates. Might be manageable, or divertor
    erodes, melts?
  \item Is there a way to enhance spontaneous flow to reduce
    turbulence?
  \item How does Lithium effect the edge plasma in Lithium wall and
    other experiments?
  \end{itemize}

\end{frame}
%----------------------------------------------------------------

%----------------------------------------------------------------
\begin{frame}{Edge region of tokamaks and stellerators is very
    difficult and efficient numerical methods are needed}

  Detailed understanding of edge physics is relatively poor compared
  to core of tokamak.

  \begin{itemize}
  \item Tokamak edge physics remains relatively unexplored: no
    self-consistent model of cross-field transport in open-field line
    region, very little study of neutral transport, wall effects, etc.
  \item Large density/amplitude variations, large relative banana
    width, wide range of collisionalities
    \begin{itemize}
    \item Stick with full-F simulations
    \item Need good algorithms to distinguish physical oscillations
      from numerical noise (Gibb's phenomena)
    \end{itemize}
  \item Complicated geometry and magnetic topology, X-points in
    domain, open field lines and divertor plates.
  \end{itemize}

\end{frame}
% ----------------------------------------------------------------

% ----------------------------------------------------------------
\begin{frame}{Long term goal: Accurate and stable continuum schemes
    for full-F edge gyrokinetics in 3D geometries}

  \begin{block}{Question}
    Can one develop accurate and stable schemes that conserve
    invariants, maintain positivity and use as few grid points as
    possible?
  \end{block}
  \mypause
  \begin{block}{Proposed Answer}
    Explore high-order hybrid discontinuous/continuous Galerkin
    finite-element schemes, enhanced with flux-reconstruction and a
    proper choice of velocity space basis functions.
  \end{block}
  \textcolor{red}{A robust code capable of running very
    quickly at coarse velocity space resolution while preserving all
    conservation laws of gyro-fluid/fluid equations and giving fairly
    good results. Can occasionally turn up velocity resolution for
    convergence tests.}

\end{frame}
% ----------------------------------------------------------------

% ----------------------------------------------------------------
\begin{frame}{Discontinuous Galerkin algorithms represent state-of-art
    for solution of hyperbolic partial differential equations}
  \begin{itemize}
    \small
  \item DG algorithms are a hot topic in CFD and applied
    mathematics. First introduced by Reed and Hill in 1973 for neutron
    transport in 2D.
    \mypause
  \item General formulation in a paper by Cockburn and Shu, JCP
    1998. More than 700 citations.  \mypause
  \item DG combines key advantages of finite-elements (low phase
    error, high accuracy, flexible geometries) with finite-volume
    schemes (limiters to produce positivity/monotonicity, locality)
    \mypause
  \item Certain types of DG have excellent conservation properties for
    Hamiltonian systems, low noise and low dissipation.
    \mypause
  \item DG is inherently super-convergent: in FV methods we
    interpolate $p$ points to get $p$th order accuracy. In DG
    interpolate $p$ points to get $2p-1$ order accuracy.
  \end{itemize}
  DG combined with FV schemes can lead to best-in-class explicit
  algorithms for hyperbolic PDEs.

\end{frame}
% ----------------------------------------------------------------

% ----------------------------------------------------------------
\begin{frame}{Discontinuous Galerkin can be a potential ``game
    changer'' for (gyro)kinetic plasma simulations}
  
  Edge/pedestal gyrokinetic turbulence is very challenging, 5D problem
  not yet solved. Benefits from all tricks we can find.
  \begin{itemize}
  \item Factor of 2 reduction in resolution would lead to 64$\times$
    speedup.
  \item High FLOP count, combined with data-locality means that modern
    CPU optimization techniques (cache optimization, vectorization,
    fast linear-algebra routines, etc.) and GPU optimization
    techniques can be used\footfullcite{Dickson:2010wt}.
  \end{itemize}

\end{frame}
% ----------------------------------------------------------------

% ----------------------------------------------------------------
\begin{frame}{Essential idea of Galerkin methods: $L_2$ minimization
    of errors on a finite-dimensional subspace}
  \small
  Consider a general time-dependent problem
  \begin{align*}
    f'(x,t) = G[f]
  \end{align*}
  where $G[f]$ is some operator. To approximate it expand $f(x)$ with
  a finite set of basis functions $w_k(x)$,
  \begin{align*}
    f(x,t) \approx f_h(x,t)  = \sum_{k=1}^N f_k(t) w_k(x)
  \end{align*}
  This gives discrete system
  \begin{align*}
    \sum_{k=1}^N f_k' w_k(x) = G[f_h]
  \end{align*}
  \mypause
  \begin{block}{Question}
    How to determine $f_k'$ in an optimum manner?
  \end{block}
  
\end{frame}
% ----------------------------------------------------------------

% ----------------------------------------------------------------
\begin{frame}{Essential idea of Galerkin methods: $L_2$ minimization
    of errors on a finite-dimensional subspace}
  \small
  Answer: Do an $L_2$ minimization of the error, i.e. find $f_k'$ such
  that
  \begin{align*}
    E_N = \int \left[
      \sum_{k=1}^N f_k' w_k(x) - G[f_h]\right]^2\thinspace dx
  \end{align*}
  is minimum. For minimum error $\partial E_N/\partial f_m' = 0$ for
  all $k=1,\ldots,N$. This leads to the linear system that determines
  the coefficients $f_k'$
  \begin{align*}
    \int w_m(x) \left(
      \sum_{k=1}^N f_k' w_k(x) - G[f_h]
    \right)\thinspace dx = 0
  \end{align*}
  for all $m=1,\ldots,N$.
  \mypause
  \begin{block}{Key Idea}
    Projection of residual on the basis set chosen for expansion leads
    to minimum errors in the $L_2$ sense. For this reason DG/CG
    schemes are constructed by projecting residuals of PDEs on basis
    sets.
  \end{block}

\end{frame}
% ----------------------------------------------------------------

% ----------------------------------------------------------------
\begin{frame}{What does a typical $L_2$ fit look like for
    discontinuous Galerkin scheme?}
  Discontinous Galerkin schemes use function spaces that allow
  \emph{discontinuties} across cell boundaries.
  \begin{figure}
    \setkeys{Gin}{width=0.5\linewidth,keepaspectratio}
    \incfig{v1m1.png}
    \incfig{v2m1.png}
    \caption{The best $L_2$ fit of $x^4+\sin(5x)$ with piecewise
      linear (left) and quadratic (right) basis functions.}
  \end{figure}

\end{frame}
% ----------------------------------------------------------------

% ----------------------------------------------------------------
\begin{frame}{Passive advection is a good prototype to study DG
    schemes}
  Consider the 1D passive advection equation on $I\in [L,R]$
  \begin{align*}
    \pfrac{f}{t} + \lambda \pfrac{f}{x} = 0
  \end{align*}
  with $\lambda$ the constant advection speed. $f(x,t) = f_0(x-\lambda
  t)$ is the exact solution, where $f_0(x)$ is the initial
  condition. Designing a good scheme is much harder than it looks.
  \mypause
  \begin{itemize}
  \item Discretize the domain into elements $I_j\in
    [x_{j-1/2},x_{j+1/2}]$
  \item Pick a finite-dimensional function space to represent the
    solution. For DG we usually pick polynomials in each cell but
    allow discontinuties across cell boundaries
  \item Expand $f(x,t) \approx f_h(x,t) = \sum_k f_k(t) w_k(x)$.
  \end{itemize}
  %\begin{align*}
  %  \mathcal{V}^k_m(I) \equiv \{w: w|_{I_j} \in P^k(I_j) \} \cap C^m
  %\end{align*}
  %where $P^k(I_j)$ is the space of polynomials of order at most $k$
  %on the element $I_j$.
\end{frame}
% ----------------------------------------------------------------

% ----------------------------------------------------------------
\begin{frame}{Discrete problem can be stated as finding the
    coefficients that minimize the $L_2$ norm of the residual}

  The discrete problem in DG is stated as: find $f_h$ in the function
  space such that for each basis function $\varphi$ we have
  \begin{align*}
    \int_{I_j} \varphi\left(
      \pfrac{f_h}{t} 
      + \lambda \pfrac{f_h}{x}
      \right)
    \thinspace dx = 0.
  \end{align*}
  Integrating by parts leads to the discrete \emph{weak-form}
  \begin{align*}
    \int_{I_j} \varphi \pfrac{f_h}{t}\thinspace dx
    +
    \lambda \varphi_{j+1/2}\hat{f}_{hj+1/2} - \lambda \varphi_{j-1/2}\hat{f}_{hj-1/2}
    -
    \int_{I_j}  \frac{d\varphi}{dx}\lambda f_h\thinspace dx = 0.
  \end{align*}
  Here $\hat{f}_{h} = \hat{f}(f^+_h,f^-_h)$ is the consistent
  \emph{numerical flux} on the cell boundary. Integrals are performed
  using suitable quadrature schemes.
  
\end{frame}
% ----------------------------------------------------------------

% ----------------------------------------------------------------
\begin{frame}{Picking a good numerical flux is key to stability,
    accuracy}

  \begin{columns}
    \begin{column}{0.55\textwidth}
      \begin{itemize}
        \small
      \item Take averages
        \begin{align*}
          \hat{f}_{h}(f^+_h,f^-_h) = \frac{1}{2}(f_h^+ + f_h^-)
        \end{align*}
      \item Use upwinding
        \begin{align*}
          \hat{f}_{h}(f^+_h,f^-_h) &= f_h^- \quad\mathrm{\lambda>0} \\
          &= f_h^+ \quad\mathrm{\lambda<0}
        \end{align*}
      \item Or some combination
        \begin{align*}
          \hat{f}_{h}(f^+_h,f^-_h) &= \frac{1}{2}(f_h^+ + f_h^-) \\
          &+ \frac{c}{2}(f_h^+ - f_h^-)
        \end{align*}
      \end{itemize}
    \end{column}
    \begin{column}{0.55\textwidth}
      \begin{figure}
        \setkeys{Gin}{width=1.0\linewidth,keepaspectratio}
        \incfig{v1m1-anno.png}
      \end{figure}
    \end{column}
  \end{columns}
  \small{For system of nonlinear equations (Euler, ideal MHD, etc.)
    there is cottage industry on choosing numerical fluxes. Google
    ``Riemann solvers''}

\end{frame}
% ----------------------------------------------------------------

% ----------------------------------------------------------------
\begin{frame}{Example: Piecewise constant basis functions lead to
    familiar difference equations}
  
  \begin{itemize}
  \item A central flux with piecewise constant basis functions leads
    to the familiar central difference scheme
    \begin{align*}
      \pfrac{f_{j}}{t} + \lambda\frac{f_{j+1}-f_{j-1}}{2\Delta x} = 0
    \end{align*}
  \item An upwind flux with piecewise constant basis functions leads
    to the familiar upwind difference scheme (for $\lambda>0$)
    \begin{align*}
      \pfrac{f_{j}}{t} + \lambda \frac{f_{j}-f_{j-1}}{\Delta x} = 0
    \end{align*}
  \end{itemize}
  Solution is advanced in time using a suitable ODE solver, usually
  strong-stability preserving Runge-Kutta methods.
\end{frame}
% ----------------------------------------------------------------

% ----------------------------------------------------------------
\begin{frame}{Example: Piecewise constant basis functions with central
    flux leads to dispersive errors}

  \begin{figure}
    \setkeys{Gin}{width=0.6\linewidth,keepaspectratio}
    \incfig{advection-p0-c.png}
    \caption{Advection equation solution (black) compared to exact
      solution (red) with central fluxes and piecewise constant basis
      functions.}
  \end{figure}

\end{frame}
% ----------------------------------------------------------------

% ----------------------------------------------------------------
\begin{frame}{Example: Piecewise constant basis functions
    with upwind flux is very diffusive}

  \begin{figure}
    \setkeys{Gin}{width=0.6\linewidth,keepaspectratio}
    \incfig{advection-p0.png}
    \caption{Advection equation solution (black) compared to exact
      solution (red) with upwind fluxes and piecewise constant basis
      functions.}
  \end{figure}

\end{frame}
% ----------------------------------------------------------------

% ----------------------------------------------------------------
\begin{frame}{Example: Piecewise linear space with upwind flux leads
    to good results}

  \begin{figure}
    \setkeys{Gin}{width=0.5\linewidth,keepaspectratio}
    \incfig{advection-p1.png}
    \caption{Advection equation solution (black) compared to exact
      solution (red) with upwind fluxes and piecewise linear basis
      functions.}
  \end{figure}
  In general, with upwind fluxes and linear basis functions numerical
  diffusion goes like $|\lambda| \Delta x^3 \partial^4 f/ \partial
  x^4$.
\end{frame}
% ----------------------------------------------------------------

% ----------------------------------------------------------------
\begin{frame}{Summary of DG schemes}

  \begin{itemize}
  \item Pick basis functions. These are usually piecewise polynomials,
    but could be other suitable functions.
  \item Construct discrete weak-form using integration by parts.
  \item Pick suitable numerical fluxes (Riemann solvers) for the
    surface integrals.
  \item Pick a suitable quadrature scheme to perform surface and
    volume integrals.
  \item Use Runge-Kutta (or other suitable) schemes for evolving the
    equations in time.
  \end{itemize}
  \mypause
  Other major topics in DG: limiters for positivity/monotonicity,
  nodal v/s modal basis functions, Serendipity basis functions,
  diffusion terms, general geometry, error and accuracy analysis,
  $hp$-refinement, etc.

\end{frame}
% ----------------------------------------------------------------

% ----------------------------------------------------------------
\begin{frame}{Several fluid and kinetic problems can be written with
    Poisson bracket structure leading to phase-space advection
    equation}%

  \begin{align*}
    \pfrac{f}{t} + \{f,H\} = 0
  \end{align*}
  where $H(z^1,z^2)$ is the Hamiltonian and canonical Poisson bracket
  is
  \begin{align*}
    \{g,h\} \equiv \pfrac{g}{z^1}\pfrac{h}{z^2} -
    \pfrac{g}{z^2}\pfrac{h}{z^1}.
  \end{align*}
  Defining phase-space velocity vector $\gvec{\alpha} = (\dot{z}^1,
  \dot{z}^2)$, with $\dot{z}^i = \{z^i,H\}$ leads to \emph{phase-space
    conservation form}
  \begin{align*}
    \pfrac{f}{t} + \nabla\cdot\left(\gvec{\alpha}f\right) = 0.
  \end{align*}
\end{frame}
% ----------------------------------------------------------------

% ----------------------------------------------------------------
\begin{frame}{Example: Incompressible Euler equations in two
    dimensions serves as a model for $E\times B$ nonlinearities in
    gyrokinetics}%

  A basic model problem is the \emph{incompressible} 2D Euler
  equations written in the stream-function ($\phi$) vorticity
  ($\zeta$) formulation. Here the Hamiltonian is simply $H(x,y) =
  \phi(x,y)$.

  \begin{align*}
    \pfrac{\zeta}{t} + \nabla\cdot(\mvec{u}\zeta) = 0
  \end{align*}
  where $\mvec{u} = \nabla\phi \times \eez$. The potential is
  determined from
  \begin{align*}
    \nabla^2 \phi = -\zeta.
  \end{align*}
\end{frame}
% ----------------------------------------------------------------

% ----------------------------------------------------------------
\begin{frame}{Example: Hasegawa-Wakatani equations serve as a model
    for drift-wave turbulence in tokamak edge}%

  The Hasegawa-Wakatani equations describe $E\times B$ driven flows in
  certain limits:
  \begin{align*}
    \pfrac{n}{t} + \{\phi,n+N\} &= D(\phi-n) \\
    \pfrac{\zeta}{t} + \{\phi,\zeta\} &= D(\phi-n)
  \end{align*}
  with $\nabla^2 \phi = \zeta.$ Here $n$ is the number density
  fluctuations, $\zeta$ the $E\times B$ vorticity, $\phi$ is the
  potential, $D$ is an adiabacity parameter and $N(x)$ is the fixed
  background density profile.

\end{frame}
% ----------------------------------------------------------------

% ----------------------------------------------------------------
\begin{frame}{Example: Vlasov equation for electrostatic plasmas}%
  The Vlasov-Poisson system has the Hamiltonian
  \begin{align*}
    H(x,p) = \frac{1}{2m}p^2 + q\phi(x)
  \end{align*}
  where $q$ is species charge and $m$ is species mass and $p=mv$ is
  momentum. With this $\dot{x} = v$ and $\dot{v} =
  -q\partial\phi/\partial x$ leading to
  \begin{align*}
    \pfrac{f}{t} + v\pfrac{f}{x} -
    \frac{q}{m}\pfrac{\phi}{x}\pfrac{f}{v} = 0
  \end{align*}
\end{frame}
% ----------------------------------------------------------------

% ----------------------------------------------------------------
\begin{frame}{It is important to preserve quadratic invariants of
    these systems}%

  The incompressible Euler equations has two quadratic invariants,
  \emph{energy}
  \begin{align*}
    \pfraca{t}\int_K \frac{1}{2} |\nabla\phi|^2  d\Omega &= 0
  \end{align*}
  and \emph{enstrophy}
  \begin{align*}
    \pfraca{t}\int_K \frac{1}{2}\zeta^2 d\Omega &= 0.
  \end{align*}
  Similar invariants can be derived for Vlasov-Poisson and
  Hasegawa-Wakatani equations.  In addition, Vlasov-Poisson also
  conserves momentum.
  \mypause
  \begin{block}{Question}
    Can one design schemes that conserve these invariants?
  \end{block}

\end{frame}
% ----------------------------------------------------------------

% 16 -------------------------------------------------------------
\begin{frame}{A DG scheme is used to discretize phase-space advection
    equation}

  To discretize the equations introduce a mesh $K_j$ of the domain
  $K$. Then the discrete problem is stated as: find $\zeta_h$ in the
  space of discontinous piecewise polynomials such that for all basis
  functions $w$ we have
  \begin{align*}
    \int_{K_j} w \pfrac{\zeta_h}{t}\thinspace d\Omega 
    +
    \int_{\partial K_j}w^- \mvec{n}\cdot\gvec{\alpha}_h\hat{\zeta}_h\thinspace dS
    -
    \int_{K_j} \nabla w\cdot\gvec{\alpha}_h \zeta_h\thinspace d\Omega = 0.
  \end{align*}
  Here $\hat{\zeta}_h = \hat{\zeta}(\zeta^+_h,\zeta^-_h)$ is the
  consistent numerical flux on $\partial K_j$.
\end{frame}
% ----------------------------------------------------------------

% 16 -------------------------------------------------------------
\begin{frame}{A continuous finite element scheme is used to discretize
    Poisson equation}

  To discretize the Poisson equation the problem is stated as: find
  $\phi_h$ in the space of \emph{continuous} piecewise polynomials
  such that for all basis functions $\psi$ we have
  \begin{align*}
    \int_K \psi \nabla^2 \phi_h d\Omega = -\int_K \psi \zeta_h d\Omega
  \end{align*}
  \mypause
  \begin{block}{Questions}
    How to pick basis functions for discontinous and continuous
    spaces? We also have not specified numerical fluxes to use. How to
    pick them?  Do they effect invariants?
  \end{block}
\end{frame}
% ----------------------------------------------------------------

% ----------------------------------------------------------------
\begin{frame}{Only recently conditions for conservation of discrete
    energy and enstrophy were discovered}%
  \small
  \begin{block}{Energy Conservation}
    Liu and Shu (2000) have shown that discrete energy is conserved
    for 2D incompressible flow if \emph{basis functions for potential
      are a continous subset of the basis functions for the vorticity
      irrespective of numerical flux chosen}! We discovered extension
    to discontinous phi for the Vlasov equation.
  \end{block}

  \begin{block}{Enstrophy Conservation}
    Enstrophy is conserved only if \emph{central fluxes} are
    used. With upwind fluxes, enstrophy decays and hence the scheme is
    \emph{stable} in the $L_2$ norm.
  \end{block}

  \mypause \textcolor{red}{DG with central fluxes can be thought of as
    high-order generalization of the well-known \emph{Arakawa}
    schemes, widely used in plasma physics as well as climate
    modeling.}

\end{frame}
% ----------------------------------------------------------------

% ----------------------------------------------------------------
\begin{frame}{For Vlasov-Poisson momentum conservation is not exact
    but is \emph{independent of velocity resolution}}%

  For electrostatic problems the condition for conservation of
  discrete momentum reduces to vanishing of the average force. However
  we can show that
  \begin{align*}
    \int n_h E_h\thinspace dx \ne 0
  \end{align*}
  Hence momentum is not exactly conserved.

  \mypause One can imagine smoothing $E_h$ or solving the Poisson
  equation with higher order continuity. However, we have not yet been
  able to construct a momentum conserving scheme.
\end{frame}
% ----------------------------------------------------------------

% ----------------------------------------------------------------
\begin{frame}{Summary of hybrid DG/CG schemes for Hamiltonian systems}

  \begin{itemize}
  \item With proper choice of function spaces and a \emph{central}
    flux, both quadratic invariants are exactly conserved by the
    semi-discrete scheme.
  \item With upwind fluxes (preferred choice) energy is still
    conserved, and the scheme is stable in the $L_2$ norm of the
    solution.
  \item For Vlasov-Poisson system there are small errors in momentum
    conservation even on a coarse velocity grid, and decrease rapidly
    with spatial resolution.
  \end{itemize}
  \mypause
  \begin{block}{Questions}
    Can this scheme be modified to also conserve momentum exactly? Can
    the fully discrete scheme also exactly conserve these invariants?
    Perhaps try symplectic integrators ...
  \end{block}

\end{frame}
% ----------------------------------------------------------------

% ----------------------------------------------------------------
\begin{frame}{Prototype code named Gkeyll is being developed}%

  \begin{itemize}
    \small
  \item Gkeyll is written in C++ and is inspired by framework efforts
    like Facets, VORPAL (Tech-X Corporation) and WarpX
    (U. Washington). Uses structured grids with arbitrary
    dimension/order nodal basis functions.
  \item Package management and builds are automated via {\tt scimake}
    and {\tt bilder}, both developed at Tech-X Corporation.
  \item Linear solvers from
    Petsc\footnote{http://www.mcs.anl.gov/petsc/} are used for
    inverting stiffness matrices.
  \item Games programming language Lua\footnote{http://www.lua.org},
    used in widely played games like World of Warcraft, is used as an
    embedded scripting language to drive simulations.
  \item MPI is used for parallelization via the {\tt txbase} library
    developed at Tech-X Corporation.
  \end{itemize}
  
\end{frame}
% ----------------------------------------------------------------

% ----------------------------------------------------------------
\begin{frame}{Simulation journal with results is maintained at
    {http://www.ammar-hakim.org/sj}}
  \begin{columns}
    \begin{column}{0.55\textwidth}
      Results are presented for each of the equation systems described
      above.
      \begin{itemize}
      \item Incompressible Euler equations
      \item Hasegawa-Wakatani equations
      \item Vlasov-Poisson equations
      \end{itemize}
    \end{column}
    \begin{column}{0.5\textwidth}
      \begin{figure}
      \includemovie[attach=true,%
      text={\incfig{s121-projected-solution_00000.png}}%
      ]{\linewidth}{0.75\linewidth}{s121-swirl-flow.mov}
      \caption{Swirling flow problem. The initial Gaussian pulses
        distort strongly but regain their shapes after a period of
        $1.5$~seconds.}
      \end{figure}
    \end{column}
  \end{columns}
\end{frame}
% ----------------------------------------------------------------

% ----------------------------------------------------------------
\begin{frame}{Double shear problem is a good test for resolution of
    vortex shearing in $E\times B$ driven flows}%
  \begin{figure}
    \setkeys{Gin}{width=0.65\linewidth,keepaspectratio}
    \includemovie[attach=true,%
    text={\incfig{s128-double-shear_00000.png}}%
    ]{0.65\linewidth}{0.4875\linewidth}{s128-double-shear.mov}
    \caption{Vorticity from double shear problem with piecewise
      quadratic DG scheme on $128\times 128$ grid.}
  \end{figure}
\end{frame}
% ----------------------------------------------------------------

% ----------------------------------------------------------------
\begin{frame}{Double shear problem is a good test for resolution of
    vortex shearing in $E\times B$ driven flows}%
  \begin{columns}
    \begin{column}{0.3\textwidth}
      Vorticity at $t=8$ with different grid resolutions and
      schemes. Third order DG scheme runs faster and produces better
      results than DG2 scheme.
    \end{column}
    \begin{column}{0.7\textwidth}
      \begin{figure}
        \setkeys{Gin}{width=1.0\linewidth,keepaspectratio}
        \incfig{s125to128-double-shear-cmp.png}
      \end{figure}
    \end{column}
  \end{columns}
\end{frame}
% ----------------------------------------------------------------

% ----------------------------------------------------------------
\begin{frame}{Vortex waltz problem tests resolution of small-scale
    vortex features}%
  \begin{figure}
    \setkeys{Gin}{width=0.65\linewidth,keepaspectratio}
    \includemovie[attach=true,%
    text={\incfig{s139-vortex-waltz_00000.png}}%
    ]{0.65\linewidth}{0.4875\linewidth}{s139-vortex-waltz.mov}
    \caption{Vorticity from vortex waltz problem with piecewise
      quadratic DG scheme on $128\times 128$ grid.}
  \end{figure}
\end{frame}
% ----------------------------------------------------------------

% ----------------------------------------------------------------
\begin{frame}{Vortex waltz problem tests resolution of small-scale
    vortex features and energy and enstrophy conservation}%
  \begin{columns}
    \begin{column}{0.5\textwidth}
      \begin{figure}
        \setkeys{Gin}{width=1.0\linewidth,keepaspectratio}
        \incfig{s139-vortex-waltz_00010.png}
        \caption{Vorticity for the vortex waltz problem with the
          piecewise quadratic scheme on a $128 \times
          128$. \emph{Upwind fluxes} were used for this calculation.}
      \end{figure}
    \end{column}
    \begin{column}{0.5\textwidth}
      \begin{figure}
        \setkeys{Gin}{width=1.0\linewidth,keepaspectratio}
        \incfig{s140s141s142-vortex-waltz-totalEnergyEnstrophy_cmp.png}
        \caption{Energy and enstrophy error for vortex waltz
          problem. \emph{Central fluxes} were used and show $O(\Delta
          t)^3$ convergence on a fixed $64\times 64$ grid.}
      \end{figure}
    \end{column}
  \end{columns}
\end{frame}
% ----------------------------------------------------------------

% ----------------------------------------------------------------
\begin{frame}{Initial studies of Hasegawa-Wakatani drift-wave
    turbulence are carried out}%

\end{frame}
% ----------------------------------------------------------------

% ----------------------------------------------------------------
\begin{frame}{Linear Landau damping simulations were compared with
    exact solutions of dispersion relations}%
  \begin{columns}
    \begin{column}{0.4\textwidth}
      Field energy (blue) as a function of time for linear Landau
      damping problem with $k=0.5$ and $Te=1.0$. The red dots
      represent the maxima in the field energy which are used to
      compute a linear least-square fit. The slope of the black line
      gives the damping rate.
    \end{column}
    \begin{column}{0.6\textwidth}
      \begin{figure}
        \setkeys{Gin}{width=1.0\linewidth,keepaspectratio}
        \incfig{s151-field-energy.png}
      \end{figure}
    \end{column}
  \end{columns}
\end{frame}
% ----------------------------------------------------------------

% ----------------------------------------------------------------
\begin{frame}{Nonlinear Landau damping simulations show particle
    trapping and phase-space hole formation}%

  \begin{columns}
    \begin{column}{0.4\textwidth}
      Field energy as a function of time for nonlinear Landau damping
      problem with k=0.5, $Te=1.0$ and $\alpha=0.5$. The initial
      perturbation decays at a rate of $\gamma=‚àí0.2916$, after which
      the damping is halted from particle trapping. The growth rate of
      this phase is $\gamma=0.0879$.
    \end{column}
    \begin{column}{0.6\textwidth}
      \begin{figure}
        \setkeys{Gin}{width=1.0\linewidth,keepaspectratio}
        \incfig{s162-field-energy.png}
      \end{figure}
    \end{column}
  \end{columns}

\end{frame}
% ----------------------------------------------------------------

% ----------------------------------------------------------------
\begin{frame}{DG scheme can efficiently capture fine-scale features in
    phase-space}%

  \begin{figure}
    \setkeys{Gin}{width=0.65\linewidth,keepaspectratio}
    \includemovie[attach=true,%
    text={\incfig{s162-landau-damping-vp_distf_00000.png}}%
    ]{0.65\linewidth}{0.4875\linewidth}{s162-distf-nonlin.mov}
    \caption{Distribution function from nonlinear Landau damping problem.}
  \end{figure}

\end{frame}
% ----------------------------------------------------------------

% ----------------------------------------------------------------
\begin{frame}{DG scheme can efficiently capture fine-scale features in
    phase-space}%

  \begin{figure}
    \setkeys{Gin}{width=0.8\linewidth,keepaspectratio}
    \incfig{s162-landau-damping-vp_distf.png}
  \end{figure}

\end{frame}
% ----------------------------------------------------------------

% ----------------------------------------------------------------
\begin{frame}{Small errors in momentum conservation, independent of
    velocity space resolution and converging rapidly with spatial
    resolution}%

  \begin{columns}
    \begin{column}{0.5\textwidth}
      \begin{tabulary}{\linewidth}{|L|L|L|}
        \hline
        
          $N_x$
        & {
          Error DG2
        } & {
          Order
        }\\\hline
        8
        & 
        $1.3332\times 10^{-3}$
        &  
        \\\hline
        
        16
        & 
        $3.9308\times 10^{-4}$
        & 
        1.76
        \\\hline
        
        32
        & 
        $8.5969\times 10^{-5}$
        & 
        2.19
        \\\hline
        
        64
        & 
        $1.5254\times 10^{-5}$
        & 
        2.49
        \\\hline
        
        128
        & 
        $2.3105\times 10^{-6}$
        & 
        2.72
        \\\hline
      \end{tabulary}
    \end{column}
    \begin{column}{0.5\textwidth}
      \begin{tabulary}{\linewidth}{|L|L|L|}
        \hline
        $N_x$
        & {
          Error DG3
        } & {
          Order
        }\\\hline
        8
        & 
        $1.9399\times 10^{-5}$
        &  
        \\\hline
        
        16
        & 
        $4.0001\times 10^{-7}$
        & 
        5.60
        \\\hline
        
        32
        & 
        $5.1175\times 10^{-8}$
        & 
        2.97
        \\\hline

        64
        & 
        $2.2289\times 10^{-9}$
        & 
        4.52
        \\\hline

        128
        & 
        $8.9154\times 10^{-11}$
        & 
        4.64
        \\\hline
      \end{tabulary}
    \end{column}
  \end{columns}

\end{frame}
% ----------------------------------------------------------------

% ----------------------------------------------------------------
\begin{frame}{A particle, momentum and energy conserving
    Lenard-Bernstein collision operator is implemented}%

  \begin{columns}
    \small
    \begin{column}{0.4\textwidth}
      A simple collision operator is implemented:
      \begin{align*}
        C_{LB}[f] = \nu \frac{\partial }{\partial v}\left( (v-u)f + v_t^2 \pfrac{f}{v} \right)
      \end{align*}
      Figure shows relaxation of an initial step-function distribution
      function to Maxwellian due to collisions.
    \end{column}
    \begin{column}{0.6\textwidth}
      \begin{figure}
        \setkeys{Gin}{width=1.0\linewidth,keepaspectratio}
        \incfig{lb-collisions.png}
      \end{figure}
    \end{column}
  \end{columns}
\end{frame}
% ----------------------------------------------------------------

% ----------------------------------------------------------------
\begin{frame}{Conclusions: Our tests confirm that DG algorithms are
    promising for kinetic problems}%

  \begin{itemize}
  \item A discontinuous Galerkin scheme to solve a general class of
    Hamiltonian field equations is presented.
  \item The Poisson equation is discretized using continuous basis
    functions.
  \item With proper choice of basis functions energy is
    conserved. 
  \item With central fluxes enstrophy is conserved. With upwind fluxes
    the scheme is $L_2$ stable.
  \item Momentum conserved has small errors but is independent of
    velocity space resolution and converges rapidly with spatial
    resolution.
  \end{itemize}

\end{frame}
% ----------------------------------------------------------------

% ----------------------------------------------------------------
\begin{frame}{Future work: extend scheme to higher dimensions, general
    geometries and do first physics problems}%

  \begin{itemize}
  \item The schemes have been extended to higher dimensions and
    Serendipity basis functions are being explored (along with Eric
    Shi). Testing is in progress.
  \item Maxwellian weighted basis functions for velocity space
    discretization will be developed to allow coarse resolution
    simulations with the option of fine scale resolution when needed.
  \item A collision model is implemented. It will be tested with
    standard problems and extended to higher dimensions.
  \item Extensions will be made to take into account complicated edge
    geometries using a multi-block structured grid.
  \end{itemize}
\end{frame}
% ----------------------------------------------------------------
conservation, Maxwellian basis functions, hypercollisions as subgrid models.

\end{document}

% ----------------------------------------------------------------
\begin{frame}{}%

\end{frame}
% ----------------------------------------------------------------

%%% EXTRA STUFF: BELOW THIS NOTHING GETS TEXED

% ----------------------------------------------------------------
\begin{frame}{Essential idea of Galerkin methods: $L_2$ minimization
    of errors on a finite-dimensional subspace}
  \small
  Consider expanding a function $f(x)$ with a finite set of basis
  functions $w_k(x)$
  \begin{align*}
    f(x) \approx f_h(x)  = \sum_{k=1}^N f_k w_k(x)
  \end{align*}
  Question: What are best values of $f_k$ one can select?  \mypause
  Answer: Do an $L_2$ minimization of the error, i.e. find $f_k$ such
  that
  \begin{align*}
    E_N = \int \left[
      f(x) - \sum_{k=1}^N f_k w_k(x)\right]^2\thinspace dx
  \end{align*}
  is minimum.

\end{frame}
% ----------------------------------------------------------------

% ----------------------------------------------------------------
\begin{frame}{Essential idea of Galerkin methods: $L_2$ minimization
    of errors on a finite-dimensional subspace}

  For minimum error $\partial E_N/\partial f_k = 0$ for all
  $k=1,\ldots,N$. This leads to the linear system that determines the
  coefficients $f_k$
  \begin{align*}
    \int w_m(x) \left(
      f(x) - \sum_{k=1}^N f_k w_k(x)
    \right)\thinspace dx = 0
  \end{align*}
  for all $m=1,\ldots,N$.
  \mypause
  \begin{block}{Key Idea}
    Projection of original function on the basis set chosen for
    expansion leads to minimum errors in the $L_2$ sense. For this
    reason DG/CG schemes are constructed by projecting residuals of
    PDEs on basis sets.
  \end{block}

\end{frame}
% ----------------------------------------------------------------
