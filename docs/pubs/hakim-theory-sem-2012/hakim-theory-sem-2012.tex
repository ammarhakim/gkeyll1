 \documentclass[pdf]{beamer}
\usepackage{biblatex}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{caption}
\usepackage{longtable}
\usepackage{multirow}
\usepackage{tabulary}

\captionsetup{font=scriptsize,labelfont=scriptsize}

\DeclareMathAlphabet{\mathpzc}{OT1}{pzc}{m}{it}

\newcommand{\eqr}[1]{Eq.\thinspace(#1)}
\newcommand{\pfrac}[2]{\frac{\partial #1}{\partial #2}}
\newcommand{\pfracc}[2]{\frac{\partial^2 #1}{\partial #2^2}}
\newcommand{\pfraca}[1]{\frac{\partial}{\partial #1}}
\newcommand{\pfracb}[2]{\partial #1/\partial #2}
\newcommand{\pfracbb}[2]{\partial^2 #1/\partial #2^2}
\newcommand{\spfrac}[2]{{\partial_{#1}} {#2}}
\newcommand{\mvec}[1]{\mathbf{#1}}
\newcommand{\gvec}[1]{\boldsymbol{#1}}
\newcommand{\script}[1]{\mathpzc{#1}}
\newcommand{\eep}{\mvec{e}_\phi}
\newcommand{\eer}{\mvec{e}_r}
\newcommand{\eez}{\mvec{e}_z}
\newcommand{\iprod}[2]{\langle{#1}\rangle_{#2}}
%\newcommand{\mypause}{\pause}
\newcommand{\mypause}{}

\newtheorem{thm}{Theorem}
\newtheorem{lem}{Lemma}

\theoremstyle{definition}
\newtheorem{dfn}{Definition}
%\newtheorem{thm}{Theorem}
\newtheorem{proposed}{Proposed Answer}
\DeclareMathOperator{\spn}{span}

%% autoscaled figures
\newcommand{\incfig}{\centering\includegraphics}
\setkeys{Gin}{width=0.7\linewidth,keepaspectratio}

\usepackage{beamerthemesplit}
\setbeamercovered{transparent}
\usetheme{lined}
%\usetheme{CambridgeUS}
\usecolortheme{dolphin}

% Setup TikZ
\usepackage{tikz}
\usetikzlibrary{arrows}
\tikzstyle{block}=[draw opacity=0.7,line width=1.4cm]

\title[Continuum Discontinuous Galerkin Algorithms]{An overview of
  discontinuous Galerkin algorithms with applications to (gyro)
  kinetic simulations of plasmas}%
\author{A. H. Hakim \and G. W. Hammett}%

\institute[http://www.ammar-hakim.org/sj] % (optional, aber oft n√∂tig)
{
  Princeton Plasma Physics Laboratory, Princeton, NJ\\
  ammar@princeton.edu\\
  \url{http://www.ammar-hakim.org/sj}
}

\date[Theory Seminar]{PPPL Theory Seminar, 13$^\mathrm{th}$~December
  2012}

\bibliography{gke}
%\footfullcite{jones00}
\begin{document}

\begin{frame}
  \titlepage
\end{frame}

% ----------------------------------------------------------------
\begin{frame}{Edge region is very important but poorly understood}

  \begin{figure}
    \setkeys{Gin}{width=0.75\linewidth,keepaspectratio}
    \incfig{edge-important.png}
  \end{figure}

  \begin{itemize}
  \item Need sufficiently high pedestal temperature for core to get to
    fusion temperatures
  \item Periodic instabilities in edge region can dump outer ~5-10\%
    of plasma onto divertor plates. Might be manageable, or divertor
    erodes, melts?
  \item Is there a way to enhance spontaneous flow to reduce
    turbulence?
  \end{itemize}

\end{frame}
% ----------------------------------------------------------------

% ----------------------------------------------------------------
\begin{frame}{Edge region is very difficult and efficient numerical
    methods are needed}

  Detailed understanding of edge physics is relatively poor compared
  to core of tokamak.

  \begin{itemize}
  \item Tokamak edge physics remains relatively unexplored: no
    self-consistent model of cross-field transport in open-field line
    region, very little study of neutral transport, wall effects, etc.
  \item Large density/amplitude variations, large relative banana
    width, wide range of collisionalities
    \begin{itemize}
    \item Stick with full-F simulations
    \item Need good algorithms to distinguish physical oscillations
      from numerical noise (Gibb's phenomena)
    \end{itemize}
  \item Complicated geometry and magentic topology due, X-points in
    domain, open field lines and divertor plates.
  \end{itemize}

\end{frame}
% ----------------------------------------------------------------

% ----------------------------------------------------------------
\begin{frame}{Long term goal: Accurate and stable continuum schemes
    for full-F edge gyrokinetics in 3D geometries}

  \begin{block}{Question}
    Can one develop accurate and stable schemes that conserve
    invariants, maintain positivity and use as few grid points as
    possible?
  \end{block}

  \begin{block}{Proposed Answer}
    Explore high-order hybrid discontinuous/continuous Galerkin
    finite-element schemes, enhanced with flux-reconstruction and a
    proper choice of velocity space basis functions.
  \end{block}
  \mypause
  A robust code capable of running very quickly at coarse velocity
  space resolution while preserving all conservation laws of
  gyro-fluid/fluid equations and giving fairly good results. Can
  occasionally turn up velocity resolution for convergence tests.

\end{frame}
% ----------------------------------------------------------------

% ----------------------------------------------------------------
\begin{frame}{Discontinuous Galerkin algorithms represent state-of-art
    for solution of hyperbolic partial differential equations}
  \begin{itemize}
  \item DG algorithms are a hot topic in CFD and applied
    mathematics. General formulation in a paper by Cockburn and Shu,
    JCP 1998. More than 700 citations.  \mypause
  \item DG combines key advantages of finite-elements (low phase
    error, high accuracy, flexible geometries) with finite-volume
    schemes (limiters to produce positivity/monotonicity, locality)
    \mypause
  \item Certain type of DG have excellent conservation properties for
    Hamiltonian systems, low noise and low dissipation.
    \mypause
  \item DG is inherently super-convergent: in FV methods we
    interpolate $p$ points to get $p$th order accuracy. In DG
    interpolate $p$ points to get $2p-1$ order accuracy.
  \end{itemize}
  DG combined with FV schemes can lead to best-in-class algorithms
  for hyperbolic PDEs.

\end{frame}
% ----------------------------------------------------------------

% ----------------------------------------------------------------
\begin{frame}{Discontinuous Galerkin can be a potential ``game
    changer'' for (gyro)kinetic plasma simulations}
  
  Edge/pedestal gyrokinetic turbulence is very challenging, 5D problem
  not yet solved. Benefits from all tricks we can find: factor of 2
  reduction in resolution would lead to 64$\times$ speedup.

\end{frame}
% ----------------------------------------------------------------

% ----------------------------------------------------------------
\begin{frame}{Essential idea of Galerkin methods: $L_2$ minimization
    of errors on a finite-dimensional subspace}

  Consider expanding a function $f(x)$ with a finite set of basis
  functions $w_k(x)$
  \begin{align*}
    f(x) \approx f_h(x)  = \sum_{k=1}^N f_k w_k(x)
  \end{align*}
  Question: What are best values of $f_k$ one can select?  \mypause
  Answer: Do an $L_2$ minimization of the error, i.e. find $f_k$ such
  that
  \begin{align*}
    E_N = \int \left[
      f(x) - \sum_{k=1}^N f_k w_k(x)\right]^2\thinspace dx
  \end{align*}
  is minimum.

\end{frame}
% ----------------------------------------------------------------

% ----------------------------------------------------------------
\begin{frame}{Essential idea of Galerkin methods: $L_2$ minimization
    of errors on a finite-dimensional subspace}

  For minimum error $\partial E_N/\partial f_k = 0$ for all
  $k=1,\ldots,N$. This leads to the linear system that determines the
  coefficients $f_k$
  \begin{align*}
    \int w_m(x) \left(
      f(x) - \sum_{k=1}^N f_k w_k(x)
    \right)\thinspace dx = 0
  \end{align*}
  for all $m=1,\ldots,N$.
  \mypause
  \begin{block}{Key Idea}
    Projection of original function on the basis set choosen for
    expansion leads to minimum errors in the $L_2$ sense. For this
    reason DG/CG schemes are constructed by projecting residuals of
    PDEs on basis sets.
  \end{block}

\end{frame}
% ----------------------------------------------------------------

% ----------------------------------------------------------------
\begin{frame}{Passive advection is a good prototype to study DG
    schemes}
  Consider the 1D passive advection equation on $I\in [L,R]$
  \begin{align*}
    \pfrac{f}{t} + \lambda \pfrac{f}{x} = 0
  \end{align*}
  with $\lambda$ the constant advection speed. $f(x,t) = f_0(x-\lambda
  t)$ is the exact solution, where $f_0(x)$ is the initial condition.
  First step is to discretize the domain into elements $I_j\in
  [x_{j-1/2},x_{j+1/2}]$, and pick a finite-dimensional function space
  to represent the solution.
  \begin{align*}
    \mathcal{V}^k_m(I) \equiv \{w: w|_{K_j} \in P^k(I_j) \} \cap C^m
  \end{align*}
  where $P^k(I_j)$ is the space of polynomials of order at most $k$
  on the element $I_j$.
\end{frame}
% ----------------------------------------------------------------

% ----------------------------------------------------------------
\begin{frame}{Discrete problem can be stated as finding the
    coefficients that minimize the $L_2$ norm of the residual}

  Then the discrete problem DG is stated as: find $f_h\in
  \mathcal{V}^k_{-1}$ such that for all smooth $\varphi$ we have
  \begin{align*}
    \int_{I_j} \varphi\left(
      \pfrac{f_h}{t} 
      + \lambda \pfrac{f_h}{x}
      \right)
    \thinspace dx = 0.
  \end{align*}
  Integrating by parts leads to the discrete system
  \begin{align*}
    \int_{I_j} \varphi \pfrac{f_h}{t}\thinspace dx
    +
    \lambda \varphi_{j+1/2}\hat{f}_{hj+1/2} - \lambda \varphi_{j-1/2}\hat{f}_{hj-1/2}
    -
    \int_{I_j}  \frac{d\varphi}{dx}\lambda f_h\thinspace dx = 0.
  \end{align*}
  Here $\hat{f}_{h} = \hat{f}(f^+_h,f^-_h)$ is the consistent
  \emph{numerical flux} on the cell boundary.
  
\end{frame}

\end{document}

% ----------------------------------------------------------------
\begin{frame}{Several fluid and kinetic problems are described by a
    Hamiltonian}%

  \begin{align*}
    \pfrac{f}{t} + \{f,H\} = 0
  \end{align*}
  where $H(z^1,z^2)$ is the Hamiltonian and canonical Poisson bracket
  is
  \begin{align*}
    \{g,h\} \equiv \pfrac{g}{z^1}\pfrac{h}{z^2} -
    \pfrac{g}{z^2}\pfrac{h}{z^1}.
  \end{align*}
  Defining phase-space velocity vector $\gvec{\alpha} = (\dot{z}^1,
  \dot{z}^2)$, with $\dot{z}^i = \{z^i,H\}$ leads to \emph{phase-space
    conservation form}
  \begin{align*}
    \pfrac{f}{t} + \nabla\cdot\left(\gvec{\alpha}f\right) = 0.
  \end{align*}
  Additionally $\nabla\cdot\gvec{\alpha} = 0$ (Liouville theorem).
\end{frame}
% ----------------------------------------------------------------

% ----------------------------------------------------------------
\begin{frame}{Example: Incompressible Euler equations in two
    dimensions serves as a model for $E\times B$ nonlinearities in
    gyrokinetics}%

  A basic model problem is the \emph{incompressible} 2D Euler
  equations written in the stream-function ($\phi$) vorticity ($f$)
  formulation. Here the Hamiltonian is simply $H(x,y) = \phi(x,y)$.

  \begin{align*}
    \pfrac{f}{t} + \nabla\cdot(\mvec{u}f) = 0
  \end{align*}
  where $u_x = \{x,H\} = \partial\phi/\partial y$ and $u_y = \{y,H\} =
  -\partial\phi/\partial x$. The potential is determined from
  \begin{align*}
    \nabla^2 \phi = -f.
  \end{align*}
\end{frame}
% ----------------------------------------------------------------

% ----------------------------------------------------------------
\begin{frame}{Example: Vlasov equation for electrostatic plasmas}%
  The Vlasov-Poisson system has the Hamiltonian
  \begin{align*}
    H(x,p) = \frac{1}{2m}p^2 + q\phi(x)
  \end{align*}
  where $q$ is species charge and $m$ is species mass and $p=mv$ is
  momentum. With this $\dot{x} = v$ and $\dot{v} =
  -q\partial\phi/\partial x$ leading to
  \begin{align*}
    \pfrac{f}{t} + v\pfrac{f}{x} -
    \frac{q}{m}\pfrac{\phi}{x}\pfrac{f}{v} = 0
  \end{align*}
\end{frame}
% ----------------------------------------------------------------

% ----------------------------------------------------------------
\begin{frame}{For Vlasov equation potential can be determined in two
    different ways}%

  For electron plasma waves use full Poisson equation
  \begin{align*}
    \frac{\partial^2 \phi}{\partial x^2} = -\frac{\rho_c}{\epsilon_0}
  \end{align*}
  where $\rho_c = |e| (n_{io}(x) - n(x,t))$ is total charge
  density. For ion-acoustic waves use quasi-neutrality
  \begin{align*}
    n_{i}(x) = n_{eo}\left(1 + \frac{|e|\phi}{T_e}\right)
  \end{align*}
  where $n_{eo}$ is the constant electron initial density and $T_e$ is
  the fixed electron temperature. This determines potential without
  the need to solve a Poisson equation and is a model of parallel
  dynamics in gyrokinetics.

\end{frame}
% ----------------------------------------------------------------

% ----------------------------------------------------------------
\begin{frame}{Gyrokinetic equation can also be derived from
    gyro-center Hamiltonian}

  In the Hamiltonian gyrokinetic theory\footfullcite{Brizard:2007fs}
  the gyrokinetic equation is derived from the gyrocentre Hamiltonian
  in gyro-center coordinates $(\mvec{R}, v_{\parallel}, \mu, \alpha)$
  \begin{align*}
    H = \frac{1}{2}m_i v_{\parallel}^2 + \mu B + e_i \langle\phi \rangle_\alpha
  \end{align*}
  where $v_{\parallel}$ is the parallel velocity, $\mu$ is the
  magnetic moment, $\alpha$ is gyro-angle and $\phi$ is the
  electrostatic potential. Poisson bracket is no longer canonical, but
  gyrokinetic Vlasov equation can still be written as a conservation
  equation in phase-space.
\end{frame}
% ----------------------------------------------------------------

% ----------------------------------------------------------------
\begin{frame}{Invariants for Hamiltonian systems can be derived by
    looking at \emph{weak-form} of equations}%

  Multiplying conservation law form by a smooth test function $w(x,v)$
  and integrating over an arbitrary volume element $K$ gives the
  weak-form
  \begin{align*}
    \int_K w\pfrac{f}{t}d\Omega 
    + \int_{\partial K}w^- \gvec{\alpha}\cdot\mvec{n}f dS
    - \int_K \nabla w \cdot \gvec{\alpha} f d\Omega
    = 0.
  \end{align*}
  Picking $w=1$ leads to (with periodic boundary conditions)
  \emph{particle conservation}
  \begin{align*}
    \frac{d}{dt} \int_K f d\Omega = 0.
  \end{align*}

\end{frame}
% ----------------------------------------------------------------

% ----------------------------------------------------------------
\begin{frame}{Energy conservation is derived using Hamiltonian itself
    as test function}%

  Substituting the Hamiltonian for the test function and using the
  identity $\nabla H \cdot \gvec{\alpha} = 0$ leads to
  \begin{align*}
    \int_K H \pfrac{f}{t}d\Omega = 0.
  \end{align*}
  For the incompressible Euler equation this becomes
  \begin{align*}
    \pfraca{t}\int_K \frac{1}{2} |\nabla\phi|^2  d\Omega = 0.
  \end{align*}
  For the Vlasov-Poisson system this becomes
  \begin{align*}
    \pfraca{t}\int \mathcal{E} +
    \frac{\epsilon_0}{2}\left(\pfrac{\phi}{x}\right)^2 dx = 0
  \end{align*}
  where $\mathcal{E}(x,t) \equiv \frac{1}{2}\int_{-\infty}^{\infty}
  mv^2f dv$ is the fluid energy.

\end{frame}
% ----------------------------------------------------------------

% ----------------------------------------------------------------
\begin{frame}{Generalized entropy (enstrophy) conservation can be
    derived using the solution as test function}%

  The solution itself can be used as a test function. This gives
  \begin{align*}
    \int_K f\pfrac{f}{t}d\Omega 
    + \int_{\partial K}f^- \gvec{\alpha}\cdot\mvec{n}f dS
    - \int_K \nabla f \cdot \gvec{\alpha} f d\Omega
    = 0.
  \end{align*}
  As $\nabla f \cdot \gvec{\alpha} f = \nabla\cdot (\gvec{\alpha}
  f^2/2)$ the last term reduces to a surface integral, leading to
  \begin{align*}
    \pfraca{t}\int_K \frac{1}{2}f^2 d\Omega = 0.
  \end{align*}

\end{frame}
% ----------------------------------------------------------------

% ----------------------------------------------------------------
\begin{frame}{Valsov-Poisson system also admits momentum
    conservation}%
  
  For the Vlasov-Poisson system we can select the coordinate $v$ as
  the test function. This leads to
  \begin{align*}
    \int_K v\pfrac{f}{t}d\Omega 
    + \int_{\partial K}v \gvec{\alpha}\cdot\mvec{n}f dS
    - \int_K \nabla v \cdot \gvec{\alpha} f d\Omega
    = 0.
  \end{align*}
  As $\nabla v \cdot \gvec{\alpha} = \{v,H\} = \dot{v}f$ the last term
  becomes
  \begin{align*}
    \int_K\dot{v} f d\Omega = \int \frac{|e|}{m} \pfrac{\phi}{x} n\thinspace dx.
  \end{align*}
  Using the Poisson equation to eliminate $n(x,t)$, integrating by
  parts and applying boundary condition leads to the momentum
  conservation law
  \begin{align*}
    \frac{d}{dt}\int_K vf d\Omega = 0.
  \end{align*} 
\end{frame}
% ----------------------------------------------------------------

% 16 -------------------------------------------------------------
\begin{frame}{A discontinuous finite element scheme is used to
    discretize Hamiltonian equation}

  To discretize the equations introduce a triangulation $K_\nu$ of the
  domain $K$. Pick a finite-dimensional function space
  \begin{align*}
    \mathcal{V}^k_m(K) \equiv \{w: w|_{K_\nu} \in P^k(K_\nu) \} \cap C^m
  \end{align*}
  where $P^k(K_\nu)$ is the space of polynomials of order at most $k$
  on the element $K_\nu$. Then the discrete problem is stated as: find
  $f_h\in \mathcal{V}^k_{-1}$ such that for all smooth $w$ we have
  \begin{align*}
    \int_{K_\nu} w \pfrac{f_h}{t}\thinspace d\Omega 
    +
    \int_{\partial K_\nu}w^- \mvec{n}\cdot\gvec{\alpha}_h\hat{f}_h\thinspace dS
    -
    \int_{K_\nu} \nabla w\cdot\gvec{\alpha}_h f_h\thinspace d\Omega = 0.
  \end{align*}
  Here $\hat{f}_h = \hat{f}(f^+_h,f^-_h)$ is the consistent
  \emph{numerical} flux on $\partial K_\nu$.
\end{frame}
% ----------------------------------------------------------------

% 16 -------------------------------------------------------------
\begin{frame}{A continuous finite element scheme is used to discretize
    Poisson equation}

  To discretize the Poisson equation the problem is stated as: find
  $\phi_h \in \mathcal{V}^r_0$ such that for all smooth $\psi$ we have
  \begin{align*}
    \int_K \psi \nabla^2 \phi_h d\Omega = \int_K \psi s d\Omega
  \end{align*}
  where $s$ represents the sources. For ion-acoustic waves the number
  density and potential are related by a \emph{projection} operator:
  find $\phi_h \in \mathcal{V}^k_0$ given a $n_{ih} \in
  \mathcal{V}_{-1}^k$ such that for all smooth $w$
  \begin{align*}
    \int w n_{ih}\thinspace dx = 
    n_{eo}\int w \left(1 + \frac{|e|\phi_h}{T_e}\right) dx
  \end{align*}
  This leads to a \emph{global} solve for the potential. For the case
  in which potential is allowed to be \emph{discontinuous} leading
  hence a local determination of the potential, see poster by
  G. Hammett.
\end{frame}
% ----------------------------------------------------------------

% ----------------------------------------------------------------
\begin{frame}{Only recently conditions for conservation of discrete
    energy and enstrophy were discovered}%

  Liu and Shu\footfullcite{liu-shu-2000} have shown that discrete
  energy is conserved for 2D incompressible flow if
  \begin{align*}
    \phi_h \in \mathcal{V}_0^k \subseteq f_h \in \mathcal{V}^k_{-1}
  \end{align*}
  Enstrophy (generalized entropy) is conserved if \emph{central
    fluxes} are used in the DG scheme. With upwind fluxes, enstrophy
  decays and hence the scheme is \emph{stable} in the $L_2$ norm.
\end{frame}
% ----------------------------------------------------------------

% ----------------------------------------------------------------
\begin{frame}{Momentum conservation is not exact but is independent
    of velocity resolution}%

  For electrostatic problems the condition for conservation of
  discrete momentum reduces to a vanishing average force, i.e. we must
  have
  \begin{align*}
    \int n_h E_h dx = 0
  \end{align*}
  However, one can show that as $E_h$ is discontinuous, the present
  scheme \emph{does not} satisfy this condition, and hence momentum is
  not conserved.

  One can imagine that projecting $E_h \in \mathcal{V}_{-1}^{k-1}$ to
  a smoother space $\mathcal{V}_0^{k-1}$ to make it continuous would
  help. However, even with a projection momentum is not
  conserved. Solving the Poisson equation with higher order continuity
  ($\phi_h \in \mathcal{V}_1^r$) also does not help as then the energy
  conservation condition is violated.
\end{frame}
% ----------------------------------------------------------------

% ----------------------------------------------------------------
\begin{frame}{Prototype code named Gkeyll has been developed}%

  \begin{itemize}
  \item Gkeyll is written in C++ and is inspired by framework efforts
    like Facets, VORPAL (Tech-X Corporation) and WarpX
    (U. Washington). Uses structured grids with arbitrary
    dimension/order nodal basis functions.
  \item Linear solvers from
    Petsc\footnote{http://www.mcs.anl.gov/petsc/} are used for
    inverting stiffness matrices.
  \item Games programming language Lua\footnote{http://www.lua.org},
    used in games like World of Warcraft (10 million users), is used
    as an embedded scripting language to drive simulations.
  \item MPI is used for parallelization via the {\tt txbase} library
    developed at Tech-X Corporation.
  \item Package management and builds are automated via {\tt scimake}
    and {\tt bilder}, both developed at Tech-X Corporation.
  \end{itemize}
  
\end{frame}
% ----------------------------------------------------------------

% ----------------------------------------------------------------
\begin{frame}{A simulation journal with results is maintained at
    {http://www.ammar-hakim.org/sj}}

  \begin{columns}
    \begin{column}{0.55\textwidth}
  \begin{itemize}
  \item Each algorithm is carefully tested against analytical or
    numerical results.
  \item Results are extensively documented and Lua programs are put
    online.
  \item Journal allows sharing of results as well as enables
    reproducibility as scripts, figures and notes are available via
    the internet.
  \end{itemize}
    \end{column}
    \begin{column}{0.5\textwidth}
      \begin{figure}
        \setkeys{Gin}{width=1.0\linewidth,keepaspectratio}
        \incfig{s121-snapshots.png}
        \caption{Swirling flow problem. The initial Gaussian pulses
          distort strongly but regain their shapes after a period of
          $1.5$~seconds.}
      \end{figure}
    \end{column}
  \end{columns}
\end{frame}
% ----------------------------------------------------------------

% ----------------------------------------------------------------
\begin{frame}{Accuracy and convergence of schemes was tested with
    Vlasov equation with specified potential: $\cos(x)$ potential
    well}%

  \begin{columns}
    \begin{column}{0.5\textwidth}
      \begin{figure}
        \setkeys{Gin}{width=1.0\linewidth,keepaspectratio}
        \incfig{s149-vlasov-fp_distf_00015.png}
      \end{figure}
    \end{column}
    \begin{column}{0.5\textwidth}
      \begin{figure}
        \setkeys{Gin}{width=1.0\linewidth,keepaspectratio}
        \incfig{s149-vlasov-fp_distf_00100.png}
      \end{figure}
    \end{column}
  \end{columns}
  \begin{figure}
    \caption{Distribution function at $t=3$ (left) and $t=20$ (right)
      for flow in a $\cos(x)$ potential well. A separatrix forms along
      the trapped-passing boundary. Simulation run with a DG2 scheme
      on a $64\times 128$ grid.}
  \end{figure}

  \end{frame}
% ----------------------------------------------------------------

% ----------------------------------------------------------------
  \begin{frame}{With quadratic potential $\phi(x)=x^2$ a rigid-body
      motion of trapped particles in phase-space is seen}%

  \begin{columns}
    \begin{column}{0.5\textwidth}
      \begin{figure}
        \setkeys{Gin}{width=1.0\linewidth,keepaspectratio}
        \incfig{s150-vlasov-fp_distf_00015.png}
      \end{figure}
    \end{column}
    \begin{column}{0.5\textwidth}
      \begin{figure}
        \setkeys{Gin}{width=1.0\linewidth,keepaspectratio}
        \incfig{s150-vlasov-fp_distf_00100.png}
      \end{figure}
    \end{column}
  \end{columns}
  \begin{figure}
    \caption{Distribution function at $t=3$ (left) and $t=20$ (right)
      for flow in a $x^2$ potential well. Bounce period of all trapped
      particles is the same, leading to a rigid-body motion inside
      trapped region.}
  \end{figure}

  \end{frame}
% ----------------------------------------------------------------

% ----------------------------------------------------------------
\begin{frame}{Double shear problem is a good test for resolution of
    vortex shearing in $E\times B$ driven flows}%
  \begin{columns}
    \begin{column}{0.3\textwidth}
      Vorticity at $t=8$ with different grid resolutions and
      schemes. Third order DG scheme runs faster and produces better
      results than DG2 scheme.
    \end{column}
    \begin{column}{0.7\textwidth}
      \begin{figure}
        \setkeys{Gin}{width=1.0\linewidth,keepaspectratio}
        \incfig{s125to128-double-shear-cmp.png}
      \end{figure}
    \end{column}
  \end{columns}
\end{frame}
% ----------------------------------------------------------------

% ----------------------------------------------------------------
\begin{frame}{Vortex waltz problem tests resolution of small-scale
    vortex features and energy and enstrophy conservation}%
  \begin{columns}
    \begin{column}{0.5\textwidth}
      \begin{figure}
        \setkeys{Gin}{width=1.0\linewidth,keepaspectratio}
        \incfig{s139-vortex-waltz_00010.png}
        \caption{Vorticity for the vortex waltz problem with the
          third-order scheme on a $128 \times 128$. \emph{Upwind
            fluxes} were used for this calculation.}
      \end{figure}
    \end{column}
    \begin{column}{0.5\textwidth}
      \begin{figure}
        \setkeys{Gin}{width=1.0\linewidth,keepaspectratio}
        \incfig{s140s141s142-vortex-waltz-totalEnergyEnstrophy_cmp.png}
        \caption{Energy and enstrophy error for vortex waltz
          problem. \emph{Central fluxes} were used and show $O(\Delta
          t)^3$ convergence on a fixed $64\times 64$ grid.}
      \end{figure}
    \end{column}
  \end{columns}
\end{frame}
% ----------------------------------------------------------------

% ----------------------------------------------------------------
\begin{frame}{Linear Landau damping simulations were compared with
    exact solutions of dispersion relations}%
  \begin{columns}
    \begin{column}{0.4\textwidth}
      Field energy (blue) as a function of time for linear Landau
      damping problem with $k=0.5$ and $Te=1.0$. The red dots
      represent the maxima in the field energy which are used to
      compute a linear least-square fit. The slope of the black line
      gives the damping rate.
    \end{column}
    \begin{column}{0.6\textwidth}
      \begin{figure}
        \setkeys{Gin}{width=1.0\linewidth,keepaspectratio}
        \incfig{s151-field-energy.png}
      \end{figure}
    \end{column}
  \end{columns}
\end{frame}
% ----------------------------------------------------------------

% ----------------------------------------------------------------
\begin{frame}{Numerically computed damping rates compare accurately
    with exact results}%
  \begin{columns}
    \begin{column}{0.4\textwidth}
      Damping rate from Landau damping for electron plasma
      oscillations as a function of normalized Debye length. The
      damping rates are within 3\% of the exact values, and for large
      values of $k\lambda_D$ within 1\%.
    \end{column}
    \begin{column}{0.6\textwidth}
      \begin{figure}
        \setkeys{Gin}{width=1.0\linewidth,keepaspectratio}
        \incfig{ld-damping-rates-elc-osc.png}
      \end{figure}
    \end{column}
  \end{columns}
\end{frame}
% ----------------------------------------------------------------

% ----------------------------------------------------------------
\begin{frame}{Nonlinear Landau damping simulations show particle
    trapping and phase-space hole formation}%

  \begin{columns}
    \begin{column}{0.4\textwidth}
      Field energy as a function of time for nonlinear Landau damping
      problem with k=0.5, $Te=1.0$ and $\alpha=0.5$. The initial
      perturbation decays at a rate of $\gamma=‚àí0.2916$, after which
      the damping is halted from particle trapping. The growth rate of
      this phase is $\gamma=0.0879$.
    \end{column}
    \begin{column}{0.6\textwidth}
      \begin{figure}
        \setkeys{Gin}{width=1.0\linewidth,keepaspectratio}
        \incfig{s162-field-energy.png}
      \end{figure}
    \end{column}
  \end{columns}

\end{frame}
% ----------------------------------------------------------------

% ----------------------------------------------------------------
\begin{frame}{DG scheme can efficiently capture fine-scale features in
    phase-space}%

  \begin{figure}
    \setkeys{Gin}{width=0.8\linewidth,keepaspectratio}
    \incfig{s162-landau-damping-vp_distf.png}
  \end{figure}

\end{frame}
% ----------------------------------------------------------------

% ----------------------------------------------------------------
\begin{frame}{Energy is conserved to same order as temporal
    discretization error of $O(\Delta t)^3$ independent of
    phase-space discretization}%
  \begin{figure}
    \setkeys{Gin}{width=0.6\linewidth,keepaspectratio}
    \incfig{dg-o2-o3-energy-conservation-errors.png}
    \caption{Convergence of energy error with time-step. The red curve
      shows errors from second order scheme, black from third order
      scheme.}
  \end{figure}

\end{frame}
% ----------------------------------------------------------------

% ----------------------------------------------------------------
\begin{frame}{To test momentum conservation an asymmetric initial
    density profile needs to be used}%

  \begin{figure}
    \setkeys{Gin}{width=0.6\linewidth,keepaspectratio}
    \incfig{s183-initial-numDensity.png}
    \caption{Initial density profile to drive momentum. Using a
      symmetric density (net zero initial momentum) profile can
      lead to misleading conservation results.}
  \end{figure}

\end{frame}
% ----------------------------------------------------------------

% ----------------------------------------------------------------
\begin{frame}{Momentum is \emph{not conserved} but is independent of
    velocity space resolution and converges rapidly with spatial
    resolution and polynomial order}%

  \begin{columns}
    \begin{column}{0.5\textwidth}
      \begin{tabulary}{\linewidth}{|L|L|L|}
        \hline
        
          $N_x$
        & {
          Error DG2
        } & {
          Order
        }\\\hline
        8
        & 
        $1.3332\times 10^{-3}$
        &  
        \\\hline
        
        16
        & 
        $3.9308\times 10^{-4}$
        & 
        1.76
        \\\hline
        
        32
        & 
        $8.5969\times 10^{-5}$
        & 
        2.19
        \\\hline
        
        64
        & 
        $1.5254\times 10^{-5}$
        & 
        2.49
        \\\hline
        
        128
        & 
        $2.3105\times 10^{-6}$
        & 
        2.72
        \\\hline
      \end{tabulary}
    \end{column}
    \begin{column}{0.5\textwidth}
      \begin{tabulary}{\linewidth}{|L|L|L|}
        \hline
        $N_x$
        & {
          Error DG3
        } & {
          Order
        }\\\hline
        8
        & 
        $1.9399\times 10^{-5}$
        &  
        \\\hline
        
        16
        & 
        $4.0001\times 10^{-7}$
        & 
        5.60
        \\\hline
        
        32
        & 
        $5.1175\times 10^{-8}$
        & 
        2.97
        \\\hline

        64
        & 
        $2.2289\times 10^{-9}$
        & 
        4.52
        \\\hline

        128
        & 
        $8.9154\times 10^{-11}$
        & 
        4.64
        \\\hline
      \end{tabulary}
    \end{column}
  \end{columns}

\end{frame}
% ----------------------------------------------------------------

% ----------------------------------------------------------------
\begin{frame}{A local-DG scheme is used to discretize diffusion terms
    for use in collision operators}%

  \begin{columns}
    \begin{column}{0.4\textwidth}
      Advection-diffusion problem with local DG scheme. The initial
      condition is $sin(x)$ for which the exact solution at time $t$
      is $e^{-\alpha t}sin(x-\lambda t)$ where $\alpha$ is the
      diffusion coefficient and $\lambda$ is advection velocity. Black
      dots are exact solutions and solid lines numerical results.
    \end{column}
    \begin{column}{0.6\textwidth}
      \begin{figure}
        \setkeys{Gin}{width=1.0\linewidth,keepaspectratio}
        \incfig{advect-diffuse.png}
      \end{figure}
    \end{column}
  \end{columns}
\end{frame}
% ----------------------------------------------------------------

% ----------------------------------------------------------------
\begin{frame}{A particle, momentum and energy conserving
    Lenard-Bernstein collision operator is implemented using local DG
    diffusion solver}%

  \begin{columns}
    \begin{column}{0.4\textwidth}
      Relaxation of a step-function distribution function to
      Maxwellian due to collisions. The solid lines show distribution
      function at different times and the dots the exact Maxwellian
      distribution with specified temperature and density.
    \end{column}
    \begin{column}{0.6\textwidth}
      \begin{figure}
        \setkeys{Gin}{width=1.0\linewidth,keepaspectratio}
        \incfig{lb-collisions.png}
      \end{figure}
    \end{column}
  \end{columns}
\end{frame}
% ----------------------------------------------------------------

% ----------------------------------------------------------------
\begin{frame}{Conclusions: An efficient and accurate discontinuous
    Galerkin scheme for general Hamiltonian field equations is
    presented}%

  \begin{itemize}
  \item A discontinuous Galerkin scheme to solve a general class of
    Hamiltonian field equations is presented.
  \item The Poisson equation is discretized using continuous basis
    functions.
  \item With proper choice of basis functions energy is
    conserved. 
  \item With central fluxes enstrophy (generalize entropy) is
    conserved. With upwind fluxes the scheme is $L_2$ stable.
  \item Momentum is not conserved but is independent of velocity space
    resolution and converges rapidly with spatial resolution and
    polynomial order of the scheme.
  \end{itemize}

\end{frame}
% ----------------------------------------------------------------

% ----------------------------------------------------------------
\begin{frame}{Future work: extend scheme to higher dimensions and
    general geometries and collision terms}%

  \begin{itemize}
  \item Higher-order basis functions have been implemented and are
    being tested.
  \item The schemes will be extended to take into account complicated
    edge geometries using a multi-block structured grid.
  \item Special basis functions for velocity space discretization will
    be developed to allow coarse resolution simulations with the
    option of fine scale resolution when needed.
  \item A collision model has been implemented. It will be extended to
    higher dimensions.
  \end{itemize}

\end{frame}
% ----------------------------------------------------------------

\end{document}

% ----------------------------------------------------------------
\begin{frame}{}%

\end{frame}
% ----------------------------------------------------------------


  \begin{columns}
    \begin{column}{0.55\textwidth}
    \end{column}
    \begin{column}{0.5\textwidth}
      \begin{figure}
    \end{column}
  \end{columns}

