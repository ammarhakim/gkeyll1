\documentclass[pdf]{beamer}
\usepackage{biblatex}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{caption}
\usepackage{longtable}
\usepackage{multirow}
\usepackage{tabulary}
\usepackage{movie15}


\captionsetup{font=scriptsize,labelfont=scriptsize}
\footnotesize\small

\DeclareMathAlphabet{\mathpzc}{OT1}{pzc}{m}{it}

\newcommand{\eqr}[1]{Eq.\thinspace(#1)}
\newcommand{\pfrac}[2]{\frac{\partial #1}{\partial #2}}
\newcommand{\pfracc}[2]{\frac{\partial^2 #1}{\partial #2^2}}
\newcommand{\pfraca}[1]{\frac{\partial}{\partial #1}}
\newcommand{\pfracb}[2]{\partial #1/\partial #2}
\newcommand{\pfracbb}[2]{\partial^2 #1/\partial #2^2}
\newcommand{\spfrac}[2]{{\partial_{#1}} {#2}}
\newcommand{\mvec}[1]{\mathbf{#1}}
\newcommand{\gvec}[1]{\boldsymbol{#1}}
\newcommand{\script}[1]{\mathpzc{#1}}
\newcommand{\eep}{\mvec{e}_\phi}
\newcommand{\eer}{\mvec{e}_r}
\newcommand{\eez}{\mvec{e}_z}
\newcommand{\iprod}[2]{\langle{#1}\rangle_{#2}}
%\newcommand{\mypause}{\pause}
\newcommand{\mypause}{}

\newtheorem{thm}{Theorem}
\newtheorem{lem}{Lemma}

\theoremstyle{definition}
\newtheorem{dfn}{Definition}
%\newtheorem{thm}{Theorem}
\newtheorem{proposed}{Proposed Answer}
\DeclareMathOperator{\spn}{span}

%% autoscaled figures
\newcommand{\incfig}{\centering\includegraphics}
\setkeys{Gin}{width=0.7\linewidth,keepaspectratio}

\usepackage{beamerthemesplit}
\setbeamercovered{transparent}
\usetheme{lined}
%\usetheme{CambridgeUS}
\usecolortheme{dolphin}

\usefonttheme[onlymath]{serif}
\setbeamertemplate{navigation symbols}{}

% Setup TikZ
\usepackage{tikz}
\usetikzlibrary{arrows}
\tikzstyle{block}=[draw opacity=0.7,line width=1.4cm]

\title[Continuum Discontinuous Galerkin Algorithms]{Discontinuous
  Galerkin algorithms for (gyro) kinetic simulations of turbulence in
  plasmas}%
\author{A. H. Hakim \and G. W. Hammett}%

\institute[http://www.ammar-hakim.org/sj] % (optional, aber oft n√∂tig)
{
  Princeton Plasma Physics Laboratory, Princeton, NJ\\
  ammar@princeton.edu\\
  \url{http://www.ammar-hakim.org/sj}
}

\date[MPI/PU/PPPL]{Max-Planck/Princeton Center Discussions, January
  4$^\mathrm{th}$ 2013}

\bibliography{gke}
%\footfullcite{jones00}
\begin{document}

\begin{frame}
  \titlepage
\end{frame}

% ----------------------------------------------------------------
\begin{frame}{Long term goal: Accurate and stable continuum schemes
    for full-F edge gyrokinetics in 3D geometries}

  \begin{block}{Question}
    \small
    Can one develop accurate and stable schemes that conserve
    invariants, maintain positivity and use as few grid points as
    possible?
  \end{block}
  \mypause
  \begin{block}{Proposed Answer}
    \small Explore high-order hybrid discontinuous/continuous Galerkin
    finite-element schemes, enhanced with flux-reconstruction and a
    better choice of velocity space basis functions.
  \end{block}

\end{frame}
% ----------------------------------------------------------------

% ----------------------------------------------------------------
\begin{frame}{Long term goal: Accurate and stable continuum schemes
    for full-F edge gyrokinetics in 3D geometries}

  \begin{block}{Dream Goal}
    \textcolor{red}{A robust code capable of running very quickly at
      coarse velocity space resolution while preserving all
      conservation laws of gyro-fluid/fluid equations and giving
      fairly good results. Can occasionally turn up velocity
      resolution for convergence tests.}
  \end{block}
  \mypause
  To achieve this, exploring combination of techniques
  \begin{itemize}
  \item Efficient, high order, hybrid DG/finite-element scheme with
    excellent conservation properties.
  \item Subgrid turbulence models/hypercollision operators and
    limiters than enable robust results on coarse grids.
  \item Maxwellian-weighted basis functions.
  \end{itemize}

\end{frame}
% ----------------------------------------------------------------

% ----------------------------------------------------------------
\begin{frame}{Discontinuous Galerkin algorithms represent state-of-art
    for solution of hyperbolic partial differential equations}
  \begin{itemize}
    \small
  \item DG algorithms hot topic in CFD and applied mathematics. First
    introduced by Reed and Hill in 1973 for neutron transport in 2D.
    \mypause
  \item General formulation in paper by Cockburn and Shu, JCP
    1998. More than 700 citations.  \mypause
  \item DG combines key advantages of finite-elements (low phase
    error, high accuracy, flexible geometries) with finite-volume
    schemes (limiters to produce positivity/monotonicity, locality)
    \mypause
  \item Certain types of DG have excellent conservation properties for
    Hamiltonian systems, low noise and low dissipation.
    \mypause
  \item DG is inherently super-convergent: in FV methods interpolate
    $p$ points to get $p$th order accuracy. In DG interpolate $p$
    points to get $2p-1$ order accuracy.
  \end{itemize}
  DG combined with FV schemes can lead to best-in-class explicit
  algorithms for hyperbolic PDEs.

\end{frame}
% ----------------------------------------------------------------

% ----------------------------------------------------------------
\begin{frame}{Discontinuous Galerkin can be a potential ``game
    changer'' for (gyro)kinetic plasma simulations}
  
  Edge/pedestal gyrokinetic turbulence is very challenging, 5D problem
  not yet solved. Benefits from all tricks we can find.
  \begin{itemize}
  \item Factor of 2 reduction in resolution would lead to 64$\times$
    speedup.
  \item Higher order methods require more FLOPs per data point, but
    more efficient on modern CPUs where memory bandwidth is the
    limitation.  Combined with data-locality, means modern CPU/GPU
    optimization can be better (cache optimization, vectorization,
    fast linear-algebra routines, etc.).
  \end{itemize}

\end{frame}
% ----------------------------------------------------------------

% ----------------------------------------------------------------
\begin{frame}{What does a typical DG solution look like?}
  Discontinuous Galerkin schemes use function spaces that allow
  \emph{discontinuities} across cell boundaries.
  \begin{figure}
    \setkeys{Gin}{width=0.5\linewidth,keepaspectratio}
    \incfig{v1m1.png}
    \incfig{v2m1.png}
    \caption{The best $L_2$ fit of $x^4+\sin(5x)$ with piecewise
      linear (left) and quadratic (right) basis functions.}
  \end{figure}

\end{frame}
% ----------------------------------------------------------------

% ----------------------------------------------------------------
\begin{frame}{Several fluid and kinetic problems can be written with
    Poisson bracket structure leading to phase-space advection
    equation}%

  \begin{align*}
    \pfrac{f}{t} + \{f,H\} = 0
  \end{align*}
  where $H(z^1,z^2)$ is the Hamiltonian and canonical Poisson bracket
  is
  \begin{align*}
    \{g,h\} \equiv \pfrac{g}{z^1}\pfrac{h}{z^2} -
    \pfrac{g}{z^2}\pfrac{h}{z^1}.
  \end{align*}
  Defining phase-space velocity vector $\gvec{\alpha} = (\dot{z}^1,
  \dot{z}^2)$, with $\dot{z}^i = \{z^i,H\}$ leads to \emph{phase-space
    conservation form}
  \begin{align*}
    \pfrac{f}{t} + \nabla\cdot\left(\gvec{\alpha}f\right) = 0.
  \end{align*}
\end{frame}
% ----------------------------------------------------------------

% ----------------------------------------------------------------
\begin{frame}{Example: Incompressible Euler equations in two
    dimensions serves as a model for $E\times B$ nonlinearities in
    gyrokinetics}%

  A basic model problem is the \emph{incompressible} 2D Euler
  equations written in the stream-function ($\phi$) vorticity
  ($\zeta$) formulation. Here the Hamiltonian is simply $H(x,y) =
  \phi(x,y)$.

  \begin{align*}
    \pfrac{\zeta}{t} + \nabla\cdot(\mvec{u}\zeta) = 0
  \end{align*}
  where $\mvec{u} = \nabla\phi \times \eez$. The potential is
  determined from
  \begin{align*}
    \nabla^2 \phi = -\zeta.
  \end{align*}
\end{frame}
% ----------------------------------------------------------------

% ----------------------------------------------------------------
\begin{frame}{It is important to preserve quadratic invariants of
    these systems}%

  The incompressible Euler equations has two quadratic invariants,
  \emph{energy}
  \begin{align*}
    \pfraca{t}\int_K \frac{1}{2} |\nabla\phi|^2  d\Omega &= 0
  \end{align*}
  and \emph{enstrophy}
  \begin{align*}
    \pfraca{t}\int_K \frac{1}{2}\zeta^2 d\Omega &= 0.
  \end{align*}
  Similar invariants can be derived for Vlasov-Poisson and
  Hasegawa-Wakatani equations.  In addition, Vlasov-Poisson also
  conserves momentum.
  \mypause
  \begin{block}{Question}
    Can one design schemes that conserve these invariants?
  \end{block}

\end{frame}
% ----------------------------------------------------------------

% ----------------------------------------------------------------
\begin{frame}{We use hybrid DG/CG schemes for Hamiltonian systems}

  \begin{itemize}
  \item With proper choice of function spaces and a \emph{central}
    flux, both quadratic invariants are exactly conserved by the
    semi-discrete scheme.
  \item With upwind fluxes (preferred choice) energy is still
    conserved, and the scheme is stable in the $L_2$ norm of the
    solution.
  \item For Vlasov-Poisson system, momentum conservation is not exact,
    but the errors decrease rapidly with spatial resolution, even on a
    coarse velocity grid.
  \end{itemize}
  \mypause
  \begin{block}{Questions}
    Can this scheme be modified to conserve momentum exactly? Can time
    discretization exactly conserve these invariants?  Perhaps try
    symplectic integrators ...
  \end{block}

\end{frame}
% ----------------------------------------------------------------

% ----------------------------------------------------------------
\begin{frame}{Prototype code named Gkeyll is being developed}%

  \begin{itemize}
    \small
  \item Gkeyll is written in C++ and is inspired by framework efforts
    like Facets, VORPAL (Tech-X Corporation) and WarpX
    (U. Washington). Uses structured grids with arbitrary
    dimension/order nodal basis functions.
  \item Package management and builds are automated via {\tt scimake}
    and {\tt bilder}, both developed at Tech-X Corporation.
  \item Linear solvers from
    Petsc\footnote{http://www.mcs.anl.gov/petsc/} are used for
    inverting stiffness matrices.
  \item Programming language Lua\footnote{http://www.lua.org}, used in
    widely played games like World of Warcraft, is used as an embedded
    scripting language to drive simulations.
  \item MPI is used for parallelization via the {\tt txbase} library
    developed at Tech-X Corporation.
  \end{itemize}
  
\end{frame}
% ----------------------------------------------------------------

% ----------------------------------------------------------------
\begin{frame}{Simulation journal with results is maintained at
    {http://www.ammar-hakim.org/sj}}
  \begin{columns}
    \begin{column}{0.55\textwidth}
      Results are presented for the equation systems.
      \begin{itemize}
      \item Incompressible Euler equations
      \item Hasegawa-Wakatani equations
      \item Vlasov-Poisson equations
      \end{itemize}
    \end{column}
    \begin{column}{0.5\textwidth}
      \begin{figure}
      \includemovie[inline=false,%
      text={\incfig{s121-projected-solution_00000.png}}%
      ]{\linewidth}{0.75\linewidth}{s121-swirl-flow.mov}
      \caption{[Movie] Swirling flow problem. The initial Gaussian
        pulses distort strongly but regain their shapes after a period
        of $1.5$~seconds.}
      \end{figure}
    \end{column}
  \end{columns}
\end{frame}
% ----------------------------------------------------------------

% ----------------------------------------------------------------
\begin{frame}{Double shear problem is a good test for resolution of
    vortex shearing in $E\times B$ driven flows}%
  \begin{figure}
    \setkeys{Gin}{width=0.65\linewidth,keepaspectratio}
    \includemovie[inline=false,%
    text={\incfig{s128-double-shear_00000.png}}%
    ]{0.65\linewidth}{0.4875\linewidth}{s128-double-shear.mov}
    \caption{[Movie] Vorticity from double shear problem with piecewise
      quadratic DG scheme on $128\times 128$ grid.}
  \end{figure}
\end{frame}
% ----------------------------------------------------------------

% ----------------------------------------------------------------
\begin{frame}{Double shear problem is a good test for resolution of
    vortex shearing in $E\times B$ driven flows}%
  \begin{columns}
    \begin{column}{0.3\textwidth}
      Vorticity at $t=8$ with different grid resolutions and
      schemes. Third order DG scheme runs faster and produces better
      results than DG2 scheme.
    \end{column}
    \begin{column}{0.7\textwidth}
      \begin{figure}
        \setkeys{Gin}{width=1.0\linewidth,keepaspectratio}
        \incfig{s125to128-double-shear-cmp.png}
      \end{figure}
    \end{column}
  \end{columns}
\end{frame}
% ----------------------------------------------------------------


% ----------------------------------------------------------------
\begin{frame}{Initial studies of Hasegawa-Wakatani drift-wave
    turbulence are carried out}%
  \begin{figure}
    \setkeys{Gin}{width=0.65\linewidth,keepaspectratio}
    \includemovie[inline=false,%
    text={\incfig{s215-hw_numDens_00100.png}}%
    ]{0.65\linewidth}{0.4875\linewidth}{zonal-nonzonal-hw.mov}
    \caption{[Movie] Number density from Hasegawa-Wakatani drift-wave
      turbulence simulations with adiabacity parameter $D=0.1$ with
      (left) and without (right) zonal flow modification.}
  \end{figure}
\end{frame}
% ----------------------------------------------------------------

% ----------------------------------------------------------------
\begin{frame}{Algorithms have been tested with nonlinear Landau
    damping problem}%

  \begin{figure}
    \setkeys{Gin}{width=0.65\linewidth,keepaspectratio}
    \includemovie[inline=false,%
    text={\incfig{s162-landau-damping-vp_distf_00000.png}}%
    ]{0.65\linewidth}{0.4875\linewidth}{s162-distf.mov}
    \caption{[Movie] Distribution function from nonlinear Landau
      damping problem. Hyper-collisions are being implemented for
      phase-mixing to unresolved scales in velocity.}
  \end{figure}

\end{frame}
% ----------------------------------------------------------------

% ----------------------------------------------------------------
\begin{frame}{Conclusions: Our tests confirm that DG algorithms are
    promising for kinetic problems}%

  \begin{itemize}
  \item A discontinuous Galerkin scheme to solve a general class of
    Hamiltonian field equations is presented.
  \item The Poisson equation is discretized using continuous basis
    functions.
  \item With proper choice of basis functions energy is
    conserved. 
  \item With central fluxes enstrophy is conserved. With upwind fluxes
    the scheme is $L_2$ stable.
  \item Momentum conservation has small errors but is independent of
    velocity space resolution and converges rapidly with spatial
    resolution.
  \end{itemize}

\end{frame}
% ----------------------------------------------------------------

% ----------------------------------------------------------------
\begin{frame}{Future work: extend scheme to higher dimensions, general
    geometries and do first physics problems}%

  \begin{itemize}
    \small
  \item The schemes have been extended to higher dimensions and
    Serendipity basis functions are being explored (with Eric
    Shi). Testing is in progress.
  \item Maxwellian weighted basis functions for velocity space
    discretization will be developed to allow coarse resolution
    simulations with the option of fine scale resolution when needed.
  \item A collision model is implemented. It will be tested with
    standard problems and extended to higher dimensions.
  \item Extensions will be made to take into account complicated edge
    geometries using a multi-block structured grid.
  \end{itemize}
\end{frame}
% ----------------------------------------------------------------

\end{document}

% ----------------------------------------------------------------
\begin{frame}{}%

\end{frame}
% ----------------------------------------------------------------

%%% EXTRA STUFF: BELOW THIS NOTHING GETS TEXED

% ----------------------------------------------------------------
\begin{frame}{Essential idea of Galerkin methods: $L_2$ minimization
    of errors on a finite-dimensional subspace}
  \small
  Consider expanding a function $f(x)$ with a finite set of basis
  functions $w_k(x)$
  \begin{align*}
    f(x) \approx f_h(x)  = \sum_{k=1}^N f_k w_k(x)
  \end{align*}
  Question: What are best values of $f_k$ one can select?  \mypause
  Answer: Do an $L_2$ minimization of the error, i.e. find $f_k$ such
  that
  \begin{align*}
    E_N = \int \left[
      f(x) - \sum_{k=1}^N f_k w_k(x)\right]^2\thinspace dx
  \end{align*}
  is minimum.

\end{frame}
% ----------------------------------------------------------------

% ----------------------------------------------------------------
\begin{frame}{Essential idea of Galerkin methods: $L_2$ minimization
    of errors on a finite-dimensional subspace}

  For minimum error $\partial E_N/\partial f_k = 0$ for all
  $k=1,\ldots,N$. This leads to the linear system that determines the
  coefficients $f_k$
  \begin{align*}
    \int w_m(x) \left(
      f(x) - \sum_{k=1}^N f_k w_k(x)
    \right)\thinspace dx = 0
  \end{align*}
  for all $m=1,\ldots,N$.
  \mypause
  \begin{block}{Key Idea}
    Projection of original function on the basis set chosen for
    expansion leads to minimum errors in the $L_2$ sense. For this
    reason DG/CG schemes are constructed by projecting residuals of
    PDEs on basis sets.
  \end{block}

\end{frame}
% ----------------------------------------------------------------
